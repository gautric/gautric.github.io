<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>JBoss EAP 7 connected to WebsphereMQ running on Docker | Greg. I/O</title>
<meta name="keywords" content="en, JBoss, redhat, EAP7, WebsphereMQ, Docker">
<meta name="description" content="Last year for a previous customer I wrote an article/post about WebsphereMQ Best Practice with JBoss EAP 6. Today we will make almost the same setup but with JBoss EAP 7, WebsphereMQ Sample IVT application, and both running on Docker. This tutorial demonstrates how to configure and connect these enterprise technologies in a containerized environment. I assume you have basic knowledge of Docker commands and concepts.

Howto run JBoss EAP 7 connected to WebsphereMQ both running on Docker">
<meta name="author" content="">
<link rel="canonical" href="https://gautric.github.io/blog/2016/08/03/jboss-eap-7-connected-to-webspheremq-running-on-docker/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f247c1259a5749d481b4294f298a6c5d2074697de581723890ba552c718649ff.css" integrity="sha256-8kfBJZpXSdSBtClPKYpsXSB0aX3lgXI4kLpVLHGGSf8=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://gautric.github.io/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://gautric.github.io/android-icon-36x36.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://gautric.github.io/android-icon-36x36.png">
<link rel="apple-touch-icon" href="https://gautric.github.io/apple-icon-180x180.png">
<link rel="mask-icon" href="https://gautric.github.io/apple-icon-180x180.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://gautric.github.io/blog/2016/08/03/jboss-eap-7-connected-to-webspheremq-running-on-docker/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:url" content="https://gautric.github.io/blog/2016/08/03/jboss-eap-7-connected-to-webspheremq-running-on-docker/">
  <meta property="og:site_name" content="Greg. I/O">
  <meta property="og:title" content="JBoss EAP 7 connected to WebsphereMQ running on Docker">
  <meta property="og:description" content="Last year for a previous customer I wrote an article/post about WebsphereMQ Best Practice with JBoss EAP 6. Today we will make almost the same setup but with JBoss EAP 7, WebsphereMQ Sample IVT application, and both running on Docker. This tutorial demonstrates how to configure and connect these enterprise technologies in a containerized environment. I assume you have basic knowledge of Docker commands and concepts.
Howto run JBoss EAP 7 connected to WebsphereMQ both running on Docker">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2016-08-03T14:00:00+00:00">
    <meta property="article:modified_time" content="2016-08-03T14:00:00+00:00">
    <meta property="article:tag" content="En">
    <meta property="article:tag" content="JBoss">
    <meta property="article:tag" content="Redhat">
    <meta property="article:tag" content="EAP7">
    <meta property="article:tag" content="WebsphereMQ">
    <meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JBoss EAP 7 connected to WebsphereMQ running on Docker">
<meta name="twitter:description" content="Last year for a previous customer I wrote an article/post about WebsphereMQ Best Practice with JBoss EAP 6. Today we will make almost the same setup but with JBoss EAP 7, WebsphereMQ Sample IVT application, and both running on Docker. This tutorial demonstrates how to configure and connect these enterprise technologies in a containerized environment. I assume you have basic knowledge of Docker commands and concepts.

Howto run JBoss EAP 7 connected to WebsphereMQ both running on Docker">
      <meta name="twitter:site" content="@gautric_io">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Blog",
      "item": "https://gautric.github.io/blog/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "JBoss EAP 7 connected to WebsphereMQ running on Docker",
      "item": "https://gautric.github.io/blog/2016/08/03/jboss-eap-7-connected-to-webspheremq-running-on-docker/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "JBoss EAP 7 connected to WebsphereMQ running on Docker",
  "name": "JBoss EAP 7 connected to WebsphereMQ running on Docker",
  "description": "Last year for a previous customer I wrote an article/post about WebsphereMQ Best Practice with JBoss EAP 6. Today we will make almost the same setup but with JBoss EAP 7, WebsphereMQ Sample IVT application, and both running on Docker. This tutorial demonstrates how to configure and connect these enterprise technologies in a containerized environment. I assume you have basic knowledge of Docker commands and concepts.\nHowto run JBoss EAP 7 connected to WebsphereMQ both running on Docker\n",
  "keywords": [
    "en", "JBoss", "redhat", "EAP7", "WebsphereMQ", "Docker"
  ],
  "articleBody": "Last year for a previous customer I wrote an article/post about WebsphereMQ Best Practice with JBoss EAP 6. Today we will make almost the same setup but with JBoss EAP 7, WebsphereMQ Sample IVT application, and both running on Docker. This tutorial demonstrates how to configure and connect these enterprise technologies in a containerized environment. I assume you have basic knowledge of Docker commands and concepts.\nHowto run JBoss EAP 7 connected to WebsphereMQ both running on Docker\nPrerequisites For this lab, you need the following software:\nPackage of JBoss EAP 7 http://www.jboss.org/products/eap/download/ Docker for Linux, Mac, or Windows \u003e= 1.12 installed on your system Warning\nWarning, this is for trial/demo purposes only. A production deployment requires the purchase of a subscription for JBoss and a license for IBM WebsphereMQ.\nClone git project First of all, clone the git repository project that contains all the necessary configuration files.\ngit clone git@github.com:gautric/JBoss-WMQ.git cd JBoss-WMQ EAP 7 image creation We need to download the JBoss EAP 7 binary and create the correct Docker image for EAP 7.\nCopy the binary file to the JBoss-WMQ/jboss directory and navigate to this directory to build the image.\ncd JBoss-WMQ docker build -t jboss-ivt jboss Here’s the Dockerfile for the JBoss EAP 7 image:\n### Set the base image to Fedora FROM jboss/base-jdk:8 ## docker build -t jboss-ivt jboss ## docker run -p 8080:8080 -p 9990:9990 -t jboss-ivt ### File Author / Maintainer MAINTAINER \"Greg Autric\" \"gautric@redhat.com\" ### Set Environment ENV JBOSS_HOME /opt/jboss/jboss-eap-7.0 ENV MQM_HOME /opt/mqm ENV MQM_URL http://public.dhe.ibm.com/ibmdl/export/pub/software/websphere/messaging/mqadv/mqadv_dev90_linux_x86-64.tar.gz ### Install EAP 7.0.0 COPY jboss-eap-7.0.0.zip /opt RUN unzip /opt/jboss-eap-7.0.0.zip 1\u003e /dev/null \u0026\u0026 echo \"Install JBoss instance\" ## Change user to install some USER root RUN cd /tmp \u0026\u0026 yum install -y wget \u0026\u0026 wget ${MQM_URL} \u0026\u0026 tar -zxvf ./*.tar.gz 1\u003e /dev/null \u0026\u0026 cd MQServer \u0026\u0026 ./mqlicense.sh -text_only -accept \u0026\u0026 rpm -ivh MQSeriesJava*.rpm MQSeriesRuntime*.rpm RUN rm -rf /tmp/* ### Create Admin EAP user USER jboss RUN $JBOSS_HOME/bin/add-user.sh admin admin123! --silent ## Copy EAR and RAR RUN cp ${MQM_HOME}/java/lib/jca/wmq.jmsra.ivt.ear ${JBOSS_HOME}/standalone/deployments RUN cp ${MQM_HOME}/java/lib/jca/wmq.jmsra.rar ${JBOSS_HOME}/standalone/deployments ### JBoss configuration files COPY jboss-overlay.cli /opt COPY jboss-ejb3.xml /opt COPY jboss-web.xml /opt ### Configure EAP RUN echo \"JAVA_OPTS=\\\"\\$JAVA_OPTS -Djboss.bind.address=0.0.0.0 -Djboss.bind.address.management=0.0.0.0\\\"\" \u003e\u003e $JBOSS_HOME/bin/standalone.conf RUN ${JBOSS_HOME}/bin/jboss-cli.sh --file=/opt/jboss-overlay.cli RUN rm -rf ${JBOSS_HOME}/standalone/configuration/standalone_xml_history/current RUN chown -R jboss:jboss ${JBOSS_HOME} ### Open Ports EXPOSE 8080 9990 ### Start EAP CMD ${JBOSS_HOME}/bin/standalone.sh -c standalone-full.xml Information about this image Admin User: An admin user is created with a predefined password for management access Application and RAR: The demo application and WMQ Resource Adapter come from the official WMQ tgz We download it, install only the Java RPM packages, and copy the rar and ear files to the correct JBoss deployment directory JBoss CLI: The CLI script consists of two specific parts: Resource Adapter configuration - setting system properties for the RAR (user/pass/channel/queueManager, etc.) Deployment overlay - used to adapt/provide correct configuration from JBoss to the application jboss-web.xml to adapt war configuration jboss-ejb3.xml for providing ejb configuration It runs in embed-server mode (offline) to configure the server during image build Here’s the CLI file that configures JBoss EAP 7:\nembed-server --server-config=standalone-full.xml deployment-overlay add --name=jboss-ejb-overlay --content=/WMQ_IVT_MDB.jar/META-INF/jboss-ejb3.xml=/opt/jboss-ejb3.xml --deployments=wmq.jmsra.ivt.ear --redeploy-affected deployment-overlay add --name=jboss-web-overlay --content=/WMQ_IVT.war/WEB-INF/jboss-web.xml=/opt/jboss-web.xml --deployments=wmq.jmsra.ivt.ear --redeploy-affected # Remove unused stuff /subsystem=datasources:remove /subsystem=webservices:remove /subsystem=jpa:remove /subsystem=infinispan:remove /subsystem=ejb3:write-attribute(name=default-resource-adapter-name, value=${ejb.resource-adapter-name:wmq.jmsra.rar}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar:add(archive=wmq.jmsra.rar,transaction-support=LocalTransaction,statistics-enabled=true) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF:add(class-name=com.ibm.mq.connector.outbound.ManagedConnectionFactoryImpl,jndi-name=JMS2CF, use-java-context=false) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=hostName:add(value=${websphere.hostName:localhost}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=password:add(value=${websphere.password:mqm}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=queueManager:add(value=${websphere.queueManager:QUEUE.MANAGER}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=port:add(value=${websphere.port:1414}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=channel:add(value=${websphere.channel:SYSTEM.AUTO.SVRCONN}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=transportType:add(value=${websphere.transportType:CLIENT}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=username:add(value=${websphere.username:mqm}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF:add(class-name=com.ibm.mq.connector.outbound.ManagedConnectionFactoryImpl,jndi-name=jms/ivt/IVTCF, use-java-context=false) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=hostName:add(value=${websphere.hostName:localhost}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=password:add(value=${websphere.password:mqm}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=queueManager:add(value=${websphere.queueManager:QUEUE.MANAGER}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=port:add(value=${websphere.port:1414}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=channel:add(value=${websphere.channel:SYSTEM.AUTO.SVRCONN}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=transportType:add(value=${websphere.transportType:CLIENT}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=username:add(value=${websphere.username:mqm}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/admin-objects=QueuePool:add(class-name=com.ibm.mq.connector.outbound.MQQueueProxy,jndi-name=jms/ivt/IVTQueue,use-java-context=true,enabled=true) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/admin-objects=QueuePool/config-properties=baseQueueName:add(value=${websphere.queueName:Q_QUEUE}) /subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/admin-objects=QueuePool/config-properties=baseQueueManagerName:add(value=${websphere.queueManager:QUEUE.MANAGER}) # Websphere MQ Host and Port #/system-property=websphere.hostName:add(value=wmq-ivt) #/system-property=websphere.port:add(value=1414) # Websphere MQ configuration /system-property=websphere.transportType:add(value=CLIENT) /system-property=websphere.username:add(value=alice) /system-property=websphere.password:add(value=passw0rd) /system-property=websphere.channel:add(value=PASSWORD.SVRCONN) /system-property=websphere.queueManager:add(value=QM1) /system-property=websphere.queueName:add(value=Q_QUEUE) /system-property=websphere.resource.adapter:add(value=wmq.jmsra.rar) /system-property=ejb.resource-adapter-name:add(value=wmq.jmsra.rar) reload --admin-only=false WMQ image creation Now we’ll create the WebsphereMQ Docker image. We’ll reuse a public image to build our own version with custom configurations. Navigate back to our git repository root to build our custom image:\ncd JBoss-WMQ docker build -t wmq-ivt wmq Here’s the Dockerfile for the WebsphereMQ image:\nFROM ibmcom/mq RUN useradd alice -G mqm \u0026\u0026 \\ echo alice:passw0rd | chpasswd COPY config.mqsc /etc/mqm/ We use a minimal configuration for WebsphereMQ. The alice account is created with permissions to connect to WebsphereMQ, and we also create a simple queue for our application.\nHere’s the WebsphereMQ configuration file:\nDEFINE CHANNEL(PASSWORD.SVRCONN) CHLTYPE(SVRCONN) SET CHLAUTH(PASSWORD.SVRCONN) TYPE(BLOCKUSER) USERLIST('nobody') DESCR('Allow privileged users on this channel') SET CHLAUTH('*') TYPE(ADDRESSMAP) ADDRESS('*') USERSRC(NOACCESS) DESCR('BackStop rule') SET CHLAUTH(PASSWORD.SVRCONN) TYPE(ADDRESSMAP) ADDRESS('*') USERSRC(CHANNEL) CHCKCLNT(REQUIRED) ALTER AUTHINFO(SYSTEM.DEFAULT.AUTHINFO.IDPWOS) AUTHTYPE(IDPWOS) ADOPTCTX(YES) DEFINE QL(Q_QUEUE) REFRESH SECURITY TYPE(CONNAUTH) Docker compose to run demo Finally, we use Docker Compose to run both containers (JBoss and WebsphereMQ) together. We set up environment variables for flexible configuration, such as the WebsphereMQ hostname and port.\nversion: '2' services: jboss-ivt: image: jboss-ivt build: jboss ports: - \"8080:8080\" - \"9990:9990\" environment: JAVA_OPTS: \"-Dwebsphere.hostName=wmq-ivt -Dwebsphere.port=1414\" links: - wmq-ivt depends_on: - wmq-ivt wmq-ivt: image: wmq-ivt build: wmq environment: LICENSE: \"accept\" MQ_QMGR_NAME: \"QM1\" ports: - \"1414:1414\" Run it and check it Use docker-compose to start both the WebsphereMQ and JBoss EAP 7 containers:\ndocker-compose up Once both containers are running, navigate to IVT URL http://localhost:8080/WMQ_IVT/IVT in your browser to see the web application.\nWeb result The Application page The Result page The JMS inspection (View Message Contents) page Console output When you run the containers, you should see output similar to this (truncated for brevity):\n[mbp:~/Source/git/JBoss-WMQ]$\u003e docker-compose up Starting jbosswmq_wmq-ivt_1 Starting jbosswmq_jboss-ivt_1 Attaching to jbosswmq_wmq-ivt_1, jbosswmq_jboss-ivt_1 wmq-ivt_1 | ---------------------------------------- wmq-ivt_1 | Name: IBM MQ wmq-ivt_1 | Version: 9.0.0.0 wmq-ivt_1 | Level: p900-L160520.DE wmq-ivt_1 | BuildType: IKAP - (Production) wmq-ivt_1 | Platform: IBM MQ for Linux (x86-64 platform) wmq-ivt_1 | Mode: 64-bit wmq-ivt_1 | O/S: Linux 4.4.15-moby wmq-ivt_1 | InstName: Installation1 wmq-ivt_1 | InstDesc: wmq-ivt_1 | Primary: Yes wmq-ivt_1 | InstPath: /opt/mqm wmq-ivt_1 | DataPath: /var/mqm wmq-ivt_1 | MaxCmdLevel: 900 wmq-ivt_1 | LicenseType: Developer wmq-ivt_1 | ---------------------------------------- wmq-ivt_1 | IBM MQ queue manager 'QM1' starting. wmq-ivt_1 | The queue manager is associated with installation 'Installation1'. wmq-ivt_1 | 5 log records accessed on queue manager 'QM1' during the log replay phase. wmq-ivt_1 | Log replay for queue manager 'QM1' complete. wmq-ivt_1 | Transaction manager state recovered for queue manager 'QM1'. wmq-ivt_1 | IBM MQ queue manager 'QM1' started using V9.0.0.0. wmq-ivt_1 | ---------------------------------------- wmq-ivt_1 | QMNAME(QM1) STATUS(Running) jboss-ivt_1 | JAVA_OPTS already set in environment; overriding default settings with values: -Dwebsphere.hostName=wmq-ivt -Dwebsphere.port=1414 jboss-ivt_1 | ========================================================================= jboss-ivt_1 | jboss-ivt_1 | JBoss Bootstrap Environment jboss-ivt_1 | jboss-ivt_1 | JBOSS_HOME: /opt/jboss/jboss-eap-7.0 jboss-ivt_1 | jboss-ivt_1 | JAVA: /usr/lib/jvm/java/bin/java jboss-ivt_1 | jboss-ivt_1 | JAVA_OPTS: -server -verbose:gc -Xloggc:\"/opt/jboss/jboss-eap-7.0/standalone/log/gc.log\" -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=5 -XX:GCLogFileSize=3M -XX:-TraceClassUnloading -Dwebsphere.hostName=wmq-ivt -Dwebsphere.port=1414 -Djboss.bind.address=0.0.0.0 -Djboss.bind.address.management=0.0.0.0 jboss-ivt_1 | jboss-ivt_1 | ========================================================================= Conclusion JBoss EAP 7 proves to be highly flexible for enterprise messaging integration. In this tutorial, I used the Deployment Overlay feature for the first time, which is extremely useful when you cannot modify the original ear or war packages. We also utilized the embed-server mode to configure the JBoss instance offline during the Docker build process.\nI would like to thank the IBM Messaging team for providing the WMQ Docker hub image, which was instrumental in demonstrating the integration between JBoss EAP 7 and WebsphereMQ in a containerized environment.\nUseful links Download JBoss\nDeployment overlay model reference\nDeployment overlay tip\nDeployment overlay tutorial\nDeployment overlay sample\nWMQ Docker repo\nWMQ tgz\nWMQ configuration\nWMQ info\nDemo URL http://localhost:8080/WMQ_IVT/IVT\n",
  "wordCount" : "1174",
  "inLanguage": "en",
  "datePublished": "2016-08-03T14:00:00Z",
  "dateModified": "2016-08-03T14:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://gautric.github.io/blog/2016/08/03/jboss-eap-7-connected-to-webspheremq-running-on-docker/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Greg. I/O",
    "logo": {
      "@type": "ImageObject",
      "url": "https://gautric.github.io/apple-icon-180x180.png"
    }
  }
}
</script>
</head>

<body class="" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://gautric.github.io/" accesskey="h" title="Greg. I/O (Alt + H)">
                <img src="https://gautric.github.io/apple-icon-180x180.png" alt="" aria-label="logo"
                    height="35">Greg. I/O</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://gautric.github.io/apropos/" title="À Propos">
                    <span>À Propos</span>
                </a>
            </li>
            <li>
                <a href="https://gautric.github.io/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://gautric.github.io/contact/" title="Contact">
                    <span>Contact</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://gautric.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://gautric.github.io/blog/">Blog</a></div>
    <h1 class="post-title entry-hint-parent">
      JBoss EAP 7 connected to WebsphereMQ running on Docker
    </h1>
    <div class="post-meta"><span title='2016-08-03 14:00:00 +0000 UTC'>August 3, 2016</span>

</div>
  </header> 
  <div class="post-content"><p>Last year for a previous customer I wrote an article/post about <a href="/blog/2015/03/26/websphere-mq-jboss-eap-integration-english-version.html">WebsphereMQ Best Practice with JBoss EAP 6</a>. Today we will make almost the same setup but with JBoss EAP 7, WebsphereMQ Sample IVT application, and both running on Docker. This tutorial demonstrates how to configure and connect these enterprise technologies in a containerized environment. I assume you have basic knowledge of Docker commands and concepts.</p>
<blockquote>
<p>Howto run JBoss EAP 7 connected to WebsphereMQ both running on Docker</p>
</blockquote>
<h2 id="prerequisites">Prerequisites<a hidden class="anchor" aria-hidden="true" href="#prerequisites">#</a></h2>
<p>For this lab, you need the following software:</p>
<ul>
<li>Package of JBoss EAP 7 <a href="http://www.jboss.org/products/eap/download/">http://www.jboss.org/products/eap/download/</a></li>
<li>Docker for Linux, Mac, or Windows <em>&gt;= 1.12</em> installed on your system</li>
</ul>
<div><svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg"><symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/></symbol><symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet"><path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/></symbol></svg></div><div class="notice warning" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#warning-notice"></use></svg></span>Warning</p><p>Warning, this is for trial/demo purposes only. A production deployment requires the purchase of a subscription for JBoss and a license for IBM WebsphereMQ.</p></div>

<h2 id="clone-git-project">Clone git project<a hidden class="anchor" aria-hidden="true" href="#clone-git-project">#</a></h2>
<p>First of all, clone the git repository project that contains all the necessary configuration files.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone git@github.com:gautric/JBoss-WMQ.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> JBoss-WMQ
</span></span></code></pre></div><h2 id="eap-7-image-creation">EAP 7 image creation<a hidden class="anchor" aria-hidden="true" href="#eap-7-image-creation">#</a></h2>
<p>We need to <a href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html?product=appplatform&amp;downloadType=distributions">download the JBoss EAP 7 binary</a> and create the correct Docker image for EAP 7.</p>
<p>Copy the binary file to the JBoss-WMQ/jboss directory and navigate to this directory to build the image.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> JBoss-WMQ
</span></span><span class="line"><span class="cl">docker build -t jboss-ivt jboss
</span></span></code></pre></div><p>Here&rsquo;s the Dockerfile for the JBoss EAP 7 image:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="c">### Set the base image to Fedora</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">FROM</span><span class="w"> </span><span class="s">jboss/base-jdk:8</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="c">## docker build -t jboss-ivt jboss</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="c">## docker run -p 8080:8080 -p 9990:9990 -t jboss-ivt</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="c">### File Author / Maintainer</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">MAINTAINER</span><span class="w"> </span><span class="s">&#34;Greg</span> Autric<span class="s2">&#34; &#34;</span>gautric@redhat.com<span class="s2">&#34;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="c">### Set Environment</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">ENV</span> JBOSS_HOME  /opt/jboss/jboss-eap-7.0<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">ENV</span> MQM_HOME    /opt/mqm<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">ENV</span> MQM_URL     http://public.dhe.ibm.com/ibmdl/export/pub/software/websphere/messaging/mqadv/mqadv_dev90_linux_x86-64.tar.gz<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="c">### Install EAP 7.0.0</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">COPY</span> jboss-eap-7.0.0.zip /opt<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">RUN</span> unzip /opt/jboss-eap-7.0.0.zip  1&gt; /dev/null <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;Install JBoss instance&#34;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="c">## Change user to install some</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">USER</span><span class="w"> </span><span class="s">root</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">RUN</span> <span class="nb">cd</span> /tmp <span class="o">&amp;&amp;</span> yum install -y wget <span class="o">&amp;&amp;</span> wget <span class="si">${</span><span class="nv">MQM_URL</span><span class="si">}</span> <span class="o">&amp;&amp;</span> tar -zxvf ./*.tar.gz  1&gt; /dev/null <span class="o">&amp;&amp;</span> <span class="nb">cd</span> MQServer <span class="o">&amp;&amp;</span> ./mqlicense.sh -text_only -accept  <span class="o">&amp;&amp;</span> rpm -ivh  MQSeriesJava*.rpm MQSeriesRuntime*.rpm<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">RUN</span> rm -rf /tmp/*<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="c">### Create Admin EAP user</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">USER</span><span class="w"> </span><span class="s">jboss</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">RUN</span> <span class="nv">$JBOSS_HOME</span>/bin/add-user.sh admin admin123! --silent<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="c">## Copy EAR and RAR</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">RUN</span> cp <span class="si">${</span><span class="nv">MQM_HOME</span><span class="si">}</span>/java/lib/jca/wmq.jmsra.ivt.ear <span class="si">${</span><span class="nv">JBOSS_HOME</span><span class="si">}</span>/standalone/deployments<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">RUN</span> cp <span class="si">${</span><span class="nv">MQM_HOME</span><span class="si">}</span>/java/lib/jca/wmq.jmsra.rar     <span class="si">${</span><span class="nv">JBOSS_HOME</span><span class="si">}</span>/standalone/deployments<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="c">### JBoss configuration files</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">COPY</span> jboss-overlay.cli  /opt<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">COPY</span> jboss-ejb3.xml     /opt<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">COPY</span> jboss-web.xml      /opt<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="c">### Configure EAP</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">RUN</span> <span class="nb">echo</span> <span class="s2">&#34;JAVA_OPTS=\&#34;\$JAVA_OPTS -Djboss.bind.address=0.0.0.0 -Djboss.bind.address.management=0.0.0.0\&#34;&#34;</span> &gt;&gt; <span class="nv">$JBOSS_HOME</span>/bin/standalone.conf<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">RUN</span> <span class="si">${</span><span class="nv">JBOSS_HOME</span><span class="si">}</span>/bin/jboss-cli.sh --file<span class="o">=</span>/opt/jboss-overlay.cli<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">RUN</span> rm -rf <span class="si">${</span><span class="nv">JBOSS_HOME</span><span class="si">}</span>/standalone/configuration/standalone_xml_history/current<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">RUN</span> chown -R jboss:jboss <span class="si">${</span><span class="nv">JBOSS_HOME</span><span class="si">}</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="c">### Open Ports</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">EXPOSE</span><span class="w"> </span><span class="s">8080</span> <span class="m">9990</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="c">### Start EAP</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">CMD</span>  <span class="si">${</span><span class="nv">JBOSS_HOME</span><span class="si">}</span>/bin/standalone.sh -c standalone-full.xml<span class="err">
</span></span></span></code></pre></div><h3 id="information-about-this-image">Information about this image<a hidden class="anchor" aria-hidden="true" href="#information-about-this-image">#</a></h3>
<ul>
<li>Admin User:
<ul>
<li>An <em>admin</em> user is created with a predefined password for management access</li>
</ul>
</li>
<li>Application and RAR:
<ul>
<li>The demo application and WMQ Resource Adapter come from the <a href="http://public.dhe.ibm.com/ibmdl/export/pub/software/websphere/messaging/mqadv/mqadv_dev90_linux_x86-64.tar.gz">official WMQ tgz</a></li>
<li>We download it, install only the Java RPM packages, and copy the <em>rar</em> and <em>ear</em> files to the correct JBoss deployment directory</li>
</ul>
</li>
<li>JBoss CLI:
<ul>
<li>The CLI script consists of two specific parts:
<ul>
<li>Resource Adapter configuration - setting system properties for the RAR (user/pass/channel/queueManager, etc.)</li>
<li>Deployment overlay - used to adapt/provide correct configuration from JBoss to the application
<ul>
<li>jboss-web.xml to adapt <strong>war</strong> configuration</li>
<li>jboss-ejb3.xml for providing <strong>ejb</strong> configuration</li>
</ul>
</li>
</ul>
</li>
<li>It runs in embed-server mode (offline) to configure the server during image build</li>
</ul>
</li>
</ul>
<p>Here&rsquo;s the CLI file that configures JBoss EAP 7:</p>
<pre tabindex="0"><code>embed-server --server-config=standalone-full.xml

deployment-overlay add --name=jboss-ejb-overlay --content=/WMQ_IVT_MDB.jar/META-INF/jboss-ejb3.xml=/opt/jboss-ejb3.xml --deployments=wmq.jmsra.ivt.ear --redeploy-affected
deployment-overlay add --name=jboss-web-overlay --content=/WMQ_IVT.war/WEB-INF/jboss-web.xml=/opt/jboss-web.xml --deployments=wmq.jmsra.ivt.ear --redeploy-affected

# Remove unused stuff
/subsystem=datasources:remove
/subsystem=webservices:remove
/subsystem=jpa:remove
/subsystem=infinispan:remove

/subsystem=ejb3:write-attribute(name=default-resource-adapter-name, value=${ejb.resource-adapter-name:wmq.jmsra.rar})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar:add(archive=wmq.jmsra.rar,transaction-support=LocalTransaction,statistics-enabled=true)

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF:add(class-name=com.ibm.mq.connector.outbound.ManagedConnectionFactoryImpl,jndi-name=JMS2CF, use-java-context=false)
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=hostName:add(value=${websphere.hostName:localhost})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=password:add(value=${websphere.password:mqm})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=queueManager:add(value=${websphere.queueManager:QUEUE.MANAGER})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=port:add(value=${websphere.port:1414})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=channel:add(value=${websphere.channel:SYSTEM.AUTO.SVRCONN})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=transportType:add(value=${websphere.transportType:CLIENT})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=JMS2CF/config-properties=username:add(value=${websphere.username:mqm})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF:add(class-name=com.ibm.mq.connector.outbound.ManagedConnectionFactoryImpl,jndi-name=jms/ivt/IVTCF, use-java-context=false)
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=hostName:add(value=${websphere.hostName:localhost})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=password:add(value=${websphere.password:mqm})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=queueManager:add(value=${websphere.queueManager:QUEUE.MANAGER})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=port:add(value=${websphere.port:1414})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=channel:add(value=${websphere.channel:SYSTEM.AUTO.SVRCONN})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=transportType:add(value=${websphere.transportType:CLIENT})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/connection-definitions=IVTCF/config-properties=username:add(value=${websphere.username:mqm})

/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/admin-objects=QueuePool:add(class-name=com.ibm.mq.connector.outbound.MQQueueProxy,jndi-name=jms/ivt/IVTQueue,use-java-context=true,enabled=true)
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/admin-objects=QueuePool/config-properties=baseQueueName:add(value=${websphere.queueName:Q_QUEUE})
/subsystem=resource-adapters/resource-adapter=wmq.jmsra.rar/admin-objects=QueuePool/config-properties=baseQueueManagerName:add(value=${websphere.queueManager:QUEUE.MANAGER})

# Websphere MQ Host and Port
#/system-property=websphere.hostName:add(value=wmq-ivt)
#/system-property=websphere.port:add(value=1414)

# Websphere MQ configuration
/system-property=websphere.transportType:add(value=CLIENT)
/system-property=websphere.username:add(value=alice)
/system-property=websphere.password:add(value=passw0rd)
/system-property=websphere.channel:add(value=PASSWORD.SVRCONN)
/system-property=websphere.queueManager:add(value=QM1)
/system-property=websphere.queueName:add(value=Q_QUEUE)
/system-property=websphere.resource.adapter:add(value=wmq.jmsra.rar)
/system-property=ejb.resource-adapter-name:add(value=wmq.jmsra.rar)

reload --admin-only=false
</code></pre><h2 id="wmq-image-creation">WMQ image creation<a hidden class="anchor" aria-hidden="true" href="#wmq-image-creation">#</a></h2>
<p>Now we&rsquo;ll create the WebsphereMQ Docker image. We&rsquo;ll reuse a public image to build our own version with custom configurations.
Navigate back to our git repository root to build our custom image:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> JBoss-WMQ
</span></span><span class="line"><span class="cl">docker build -t wmq-ivt wmq
</span></span></code></pre></div><p>Here&rsquo;s the Dockerfile for the WebsphereMQ image:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">FROM</span><span class="w"> </span><span class="s">ibmcom/mq</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">RUN</span> useradd alice -G mqm <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    <span class="nb">echo</span> alice:passw0rd <span class="p">|</span> chpasswd<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">COPY</span> config.mqsc /etc/mqm/<span class="err">
</span></span></span></code></pre></div><p>We use a minimal configuration for WebsphereMQ. The <strong>alice</strong> account is created with permissions to connect to WebsphereMQ, and we also create a simple queue for our application.</p>
<p>Here&rsquo;s the WebsphereMQ configuration file:</p>
<pre tabindex="0"><code>DEFINE CHANNEL(PASSWORD.SVRCONN) CHLTYPE(SVRCONN)
SET CHLAUTH(PASSWORD.SVRCONN) TYPE(BLOCKUSER) USERLIST(&#39;nobody&#39;) DESCR(&#39;Allow privileged users on this channel&#39;)
SET CHLAUTH(&#39;*&#39;) TYPE(ADDRESSMAP) ADDRESS(&#39;*&#39;) USERSRC(NOACCESS) DESCR(&#39;BackStop rule&#39;)
SET CHLAUTH(PASSWORD.SVRCONN) TYPE(ADDRESSMAP) ADDRESS(&#39;*&#39;) USERSRC(CHANNEL) CHCKCLNT(REQUIRED)
ALTER AUTHINFO(SYSTEM.DEFAULT.AUTHINFO.IDPWOS) AUTHTYPE(IDPWOS) ADOPTCTX(YES)
DEFINE QL(Q_QUEUE)
REFRESH SECURITY TYPE(CONNAUTH)
</code></pre><h2 id="docker-compose-to-run-demo">Docker compose to run demo<a hidden class="anchor" aria-hidden="true" href="#docker-compose-to-run-demo">#</a></h2>
<p>Finally, we use Docker Compose to run both containers (JBoss and WebsphereMQ) together. We set up environment variables for flexible configuration, such as the WebsphereMQ hostname and port.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">jboss-ivt</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">jboss-ivt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l">jboss</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span>- <span class="s2">&#34;8080:8080&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span>- <span class="s2">&#34;9990:9990&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">JAVA_OPTS</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;-Dwebsphere.hostName=wmq-ivt -Dwebsphere.port=1414&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">links</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">wmq-ivt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">wmq-ivt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">wmq-ivt</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">wmq-ivt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l">wmq</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">LICENSE</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;accept&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">MQ_QMGR_NAME</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;QM1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span>- <span class="s2">&#34;1414:1414&#34;</span><span class="w">
</span></span></span></code></pre></div><h3 id="run-it-and-check-it">Run it and check it<a hidden class="anchor" aria-hidden="true" href="#run-it-and-check-it">#</a></h3>
<p>Use docker-compose to start both the <strong>WebsphereMQ</strong> and <strong>JBoss EAP 7</strong> containers:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker-compose up
</span></span></code></pre></div><p>Once both containers are running, navigate to <a href="http://localhost:8080/WMQ_IVT">IVT URL http://localhost:8080/WMQ_IVT/IVT</a> in your browser to see the web application.</p>
<h3 id="web-result">Web result<a hidden class="anchor" aria-hidden="true" href="#web-result">#</a></h3>
<h4 id="the-application-page">The Application page<a hidden class="anchor" aria-hidden="true" href="#the-application-page">#</a></h4>
<p><img alt="JBoss WebsphereMQ Application Page" loading="lazy" src="/img/jboss-wmq-1.png"></p>
<h4 id="the-result-page">The Result page<a hidden class="anchor" aria-hidden="true" href="#the-result-page">#</a></h4>
<p><img alt="JBoss WebsphereMQ Result Page" loading="lazy" src="/img/jboss-wmq-2.png"></p>
<h4 id="the-jms-inspection-view-message-contents-page">The JMS inspection (View Message Contents) page<a hidden class="anchor" aria-hidden="true" href="#the-jms-inspection-view-message-contents-page">#</a></h4>
<p><img alt="JBoss WebsphereMQ JMS Inspection Page" loading="lazy" src="/img/jboss-wmq-3.png"></p>
<h3 id="console-output">Console output<a hidden class="anchor" aria-hidden="true" href="#console-output">#</a></h3>
<p>When you run the containers, you should see output similar to this (truncated for brevity):</p>
<pre tabindex="0"><code>[mbp:~/Source/git/JBoss-WMQ]$&gt; docker-compose up
Starting jbosswmq_wmq-ivt_1
Starting jbosswmq_jboss-ivt_1
Attaching to jbosswmq_wmq-ivt_1, jbosswmq_jboss-ivt_1
wmq-ivt_1    | ----------------------------------------
wmq-ivt_1    | Name:        IBM MQ
wmq-ivt_1    | Version:     9.0.0.0
wmq-ivt_1    | Level:       p900-L160520.DE
wmq-ivt_1    | BuildType:   IKAP - (Production)
wmq-ivt_1    | Platform:    IBM MQ for Linux (x86-64 platform)
wmq-ivt_1    | Mode:        64-bit
wmq-ivt_1    | O/S:         Linux 4.4.15-moby
wmq-ivt_1    | InstName:    Installation1
wmq-ivt_1    | InstDesc:    
wmq-ivt_1    | Primary:     Yes
wmq-ivt_1    | InstPath:    /opt/mqm
wmq-ivt_1    | DataPath:    /var/mqm
wmq-ivt_1    | MaxCmdLevel: 900
wmq-ivt_1    | LicenseType: Developer
wmq-ivt_1    | ----------------------------------------
wmq-ivt_1    | IBM MQ queue manager &#39;QM1&#39; starting.
wmq-ivt_1    | The queue manager is associated with installation &#39;Installation1&#39;.
wmq-ivt_1    | 5 log records accessed on queue manager &#39;QM1&#39; during the log replay phase.
wmq-ivt_1    | Log replay for queue manager &#39;QM1&#39; complete.
wmq-ivt_1    | Transaction manager state recovered for queue manager &#39;QM1&#39;.
wmq-ivt_1    | IBM MQ queue manager &#39;QM1&#39; started using V9.0.0.0.
wmq-ivt_1    | ----------------------------------------
wmq-ivt_1    | QMNAME(QM1)                                               STATUS(Running)
jboss-ivt_1  | JAVA_OPTS already set in environment; overriding default settings with values: -Dwebsphere.hostName=wmq-ivt -Dwebsphere.port=1414
jboss-ivt_1  | =========================================================================
jboss-ivt_1  |
jboss-ivt_1  |   JBoss Bootstrap Environment
jboss-ivt_1  |
jboss-ivt_1  |   JBOSS_HOME: /opt/jboss/jboss-eap-7.0
jboss-ivt_1  |
jboss-ivt_1  |   JAVA: /usr/lib/jvm/java/bin/java
jboss-ivt_1  |
jboss-ivt_1  |   JAVA_OPTS:  -server -verbose:gc -Xloggc:&#34;/opt/jboss/jboss-eap-7.0/standalone/log/gc.log&#34; -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=5 -XX:GCLogFileSize=3M -XX:-TraceClassUnloading -Dwebsphere.hostName=wmq-ivt -Dwebsphere.port=1414 -Djboss.bind.address=0.0.0.0 -Djboss.bind.address.management=0.0.0.0
jboss-ivt_1  |
jboss-ivt_1  | =========================================================================
</code></pre><h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p><strong>JBoss EAP 7</strong> proves to be highly flexible for enterprise messaging integration. In this tutorial, I used the Deployment Overlay feature for the first time, which is extremely useful when you cannot modify the original <strong>ear</strong> or <strong>war</strong> packages. We also utilized the <strong>embed-server</strong> mode to configure the JBoss instance offline during the Docker build process.</p>
<p>I would like to thank the <em>IBM Messaging team</em> for providing the <a href="https://hub.docker.com/r/ibmcom/mq/">WMQ Docker hub image</a>, which was instrumental in demonstrating the integration between JBoss EAP 7 and WebsphereMQ in a containerized environment.</p>
<h3 id="useful-links">Useful links<a hidden class="anchor" aria-hidden="true" href="#useful-links">#</a></h3>
<ul>
<li>
<p><a href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html?product=appplatform&amp;downloadType=distributions">Download JBoss</a></p>
</li>
<li>
<p><a href="https://wildscribe.github.io/Wildfly/10.0.0.Final/deployment-overlay/index.html">Deployment overlay model reference</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/solutions/383393">Deployment overlay tip</a></p>
</li>
<li>
<p><a href="https://docs.jboss.org/author/display/AS72/Deployment+Overlays">Deployment overlay tutorial</a></p>
</li>
<li>
<p><a href="https://blog.akquinet.de/2013/06/08/deployment-overlays-a-new-feature-of-the-jboss-eap-6-1/">Deployment overlay sample</a></p>
</li>
<li>
<p><a href="https://github.com/ibm-messaging/mq-docker">WMQ Docker repo</a></p>
</li>
<li>
<p><a href="http://public.dhe.ibm.com/ibmdl/export/pub/software/websphere/messaging/mqadv/mqadv_dev90_linux_x86-64.tar.gz">WMQ tgz</a></p>
</li>
<li>
<p><a href="https://www.ibm.com/developerworks/community/blogs/messaging/entry/getting_going_without_turning_off_mq_security?lang=en">WMQ configuration</a></p>
</li>
<li>
<p><a href="http://www.ibm.com/developerworks/websphere/library/techarticles/1203_green/1203_green.html">WMQ info</a></p>
</li>
<li>
<p><a href="http://localhost:8080/WMQ_IVT">Demo URL http://localhost:8080/WMQ_IVT/IVT</a></p>
</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://gautric.github.io/tags/en/">En</a></li>
      <li><a href="https://gautric.github.io/tags/jboss/">JBoss</a></li>
      <li><a href="https://gautric.github.io/tags/redhat/">Redhat</a></li>
      <li><a href="https://gautric.github.io/tags/eap7/">EAP7</a></li>
      <li><a href="https://gautric.github.io/tags/webspheremq/">WebsphereMQ</a></li>
      <li><a href="https://gautric.github.io/tags/docker/">Docker</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://gautric.github.io/blog/2016/09/27/setup-a-hotspot-wifi-with-ansible-into-a-raspberrypi-3/">
    <span class="title">« Prev</span>
    <br>
    <span>Setup a Hotspot Wifi with Ansible into a RaspberryPi 3</span>
  </a>
  <a class="next" href="https://gautric.github.io/blog/2016/07/19/jconsole-java-mission-control-with-jboss-eap-7/">
    <span class="title">Next »</span>
    <br>
    <span>JConsole &amp; Java Mission Control with JBoss EAP 7</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2016 - 2025 <a href="https://gautric.github.io/">Greg. I/O</a></span>
    
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
</body>

</html>
