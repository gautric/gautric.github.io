<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Rhiot over Kura over Docker over RaspberryPi ;-) | Greg. I/O</title>
<meta name="keywords" content="en, Rhiot, Kura, Docker, RaspberryPi">
<meta name="description" content="During this cool Christmas day, Santa Claus brings us lot of presents (I hope for you too), I received 2 RaspberryPi Zero, Thx you brother ;-). I will show you a cool stuff after this special day. We gonna test how to use Rhiot project into Kura Eclipse Platform running inside Docker container deployed into a real RaspberryPi Zero device (in this order). If you don&rsquo;t have yet a RaspberryPi (B&#43;, 2 or zero) device you can use my previous post.">
<meta name="author" content="">
<link rel="canonical" href="https://gautric.github.io/blog/2015/12/28/rhiot-over-kura-over-docker-over-raspberrypi-/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8f91d8a03d2d03df35a93d161da5378cfcf6b504ad2ef312c29e142e3806a327.css" integrity="sha256-j5HYoD0tA981qT0WHaU3jPz2tQStLvMSwp4ULjgGoyc=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://gautric.github.io/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://gautric.github.io/android-icon-36x36.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://gautric.github.io/android-icon-36x36.png">
<link rel="apple-touch-icon" href="https://gautric.github.io/apple-icon-180x180.png">
<link rel="mask-icon" href="https://gautric.github.io/apple-icon-180x180.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://gautric.github.io/blog/2015/12/28/rhiot-over-kura-over-docker-over-raspberrypi-/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:url" content="https://gautric.github.io/blog/2015/12/28/rhiot-over-kura-over-docker-over-raspberrypi-/">
  <meta property="og:site_name" content="Greg. I/O">
  <meta property="og:title" content="Rhiot over Kura over Docker over RaspberryPi ;-)">
  <meta property="og:description" content="During this cool Christmas day, Santa Claus brings us lot of presents (I hope for you too), I received 2 RaspberryPi Zero, Thx you brother ;-). I will show you a cool stuff after this special day. We gonna test how to use Rhiot project into Kura Eclipse Platform running inside Docker container deployed into a real RaspberryPi Zero device (in this order). If you don’t have yet a RaspberryPi (B&#43;, 2 or zero) device you can use my previous post.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2015-12-28T14:00:00+00:00">
    <meta property="article:modified_time" content="2015-12-28T14:00:00+00:00">
    <meta property="article:tag" content="En">
    <meta property="article:tag" content="Rhiot">
    <meta property="article:tag" content="Kura">
    <meta property="article:tag" content="Docker">
    <meta property="article:tag" content="RaspberryPi">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Rhiot over Kura over Docker over RaspberryPi ;-)">
<meta name="twitter:description" content="During this cool Christmas day, Santa Claus brings us lot of presents (I hope for you too), I received 2 RaspberryPi Zero, Thx you brother ;-). I will show you a cool stuff after this special day. We gonna test how to use Rhiot project into Kura Eclipse Platform running inside Docker container deployed into a real RaspberryPi Zero device (in this order). If you don&rsquo;t have yet a RaspberryPi (B&#43;, 2 or zero) device you can use my previous post.">
      <meta name="twitter:site" content="@gautric_io">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Blog",
      "item": "https://gautric.github.io/blog/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Rhiot over Kura over Docker over RaspberryPi ;-)",
      "item": "https://gautric.github.io/blog/2015/12/28/rhiot-over-kura-over-docker-over-raspberrypi-/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Rhiot over Kura over Docker over RaspberryPi ;-)",
  "name": "Rhiot over Kura over Docker over RaspberryPi ;-)",
  "description": "During this cool Christmas day, Santa Claus brings us lot of presents (I hope for you too), I received 2 RaspberryPi Zero, Thx you brother ;-). I will show you a cool stuff after this special day. We gonna test how to use Rhiot project into Kura Eclipse Platform running inside Docker container deployed into a real RaspberryPi Zero device (in this order). If you don\u0026rsquo;t have yet a RaspberryPi (B+, 2 or zero) device you can use my previous post.\n",
  "keywords": [
    "en", "Rhiot", "Kura", "Docker", "RaspberryPi"
  ],
  "articleBody": "During this cool Christmas day, Santa Claus brings us lot of presents (I hope for you too), I received 2 RaspberryPi Zero, Thx you brother ;-). I will show you a cool stuff after this special day. We gonna test how to use Rhiot project into Kura Eclipse Platform running inside Docker container deployed into a real RaspberryPi Zero device (in this order). If you don’t have yet a RaspberryPi (B+, 2 or zero) device you can use my previous post.\nIn this post we will see how to integrate multiple IoT technologies in a layered approach, combining the power of Rhiot’s IoT capabilities with Kura’s OSGi-based platform, all containerized with Docker and running on the compact RaspberryPi hardware.\nHow to use Rhiot/Kura into Docker/RaspberryPi\nRequisites RaspberryPi device tested with Zero and B+ models for other models you have to rebuilt docker image Docker installation into Raspbian/Jessie or directly with Hypriot tested with both of these OS Two LED Two Resistor 220Ω Wires USB to Serial Cable RaspberryPi Zero doesn’t have too many ports I used PL-2303 USB-to-Serial Bridge Controller Docker Docker setup First of all, you have to startup your Docker environment. I prefer use Hypriot because Docker is already installed. More information to install Hypriot\nIf docker is not yet installed (Raspbian/Jessie Only):\nwget http://downloads.hypriot.com/docker-hypriot_1.9.1-1_armhf.deb sudo dpkg -i docker-hypriot_1.9.1-1_armhf.deb If docker is not started:\nsudo service docker start Build rpi-rhiot Image and take a coffee … We gonna download docker file, and run correct command to built it.\nWarning\nPlease change RPI_VERSION with your correct RaspberryPi model\nRPI_VERSION must be: raspberry-pi-2-nn or raspberry-pi-bplus-nn or raspberry-pi-nn. nn means Kura will not include network management (firewall, port, etc…), keep it cause we can ignore network management for a Docker environment.\nWe download some helper scripts and files to prepare our Docker build environment:\nmkdir rpi-rhiot cd rpi-rhiot curl https://gist.githubusercontent.com/gautric/dbe4684a6b17186afe42/raw/4aa24e22016e49b0982264845b7fe7e0311a3952/Dockerfile -O curl https://raw.githubusercontent.com/rhiot/rhiot/master/dockerfiles/rpi-rhiot/config.ini.sh -O curl https://raw.githubusercontent.com/rhiot/rhiot/master/dockerfiles/rpi-rhiot/log4j.properties -O curl https://raw.githubusercontent.com/rhiot/rhiot/master/dockerfiles/rpi-rhiot/start_kura_rhiot.sh -O sudo docker build -t rpi-rhiot . Just build it via commands above\nNow it is coffee time, let’s build docker image\nYou should get an output like this after a while to compile Rhiot Docker image.\npi@rbpiz1:~/rpi-rhiot $ sudo docker build -t rpi-rhiot . Sending build context to Docker daemon 12.29 kB Step 1 : FROM resin/rpi-raspbian:jessie ---\u003e e97a8531a526 Step 2 : MAINTAINER Greg AUTRIC ---\u003e Using cache ---\u003e 9f6d3dedf04a Step 3 : ENV CAMEL_VERSION ${CAMEL_VERSION:-2.16.1} ---\u003e Using cache ---\u003e 5695c4034847 Step 4 : ENV RHIOT_VERSION ${RHIOT_VERSION:-0.1.3} ---\u003e Using cache ---\u003e 91fb37b40966 Step 5 : ENV JAVA_VERSION ${JAVA_VERSION:-7} ---\u003e Using cache ---\u003e 5ce6f2fd7edd Step 6 : ENV KURA_VERSION ${KURA_VERSION:-1.3.0} ---\u003e Using cache ---\u003e 413de7f8e993 Step 7 : ENV RPI_VERSION ${RPI_VERSION:-raspberry-pi-bplus-nn} ---\u003e Using cache ---\u003e a584f9145729 ... OMIT ... Step 32 : RUN ${RHIOT_BIN_FOLDER}/config.ini.sh ---\u003e Using cache ---\u003e 14deb381475f Step 33 : EXPOSE 80 ---\u003e Using cache ---\u003e b5dc47bd7f51 Step 34 : EXPOSE 5002 ---\u003e Using cache ---\u003e c95b9d1593bc Step 35 : CMD ${RHIOT_BIN_FOLDER}/start_kura_rhiot.sh ---\u003e Using cache ---\u003e 4d0e0a16f2c8 Successfully built 4d0e0a16f2c8 or Pull rpi-rhiot Image and take a coffee too An other option is to pull image I’ve already built and pushed to Docker Hub. This can save you significant build time if you’re using a compatible RaspberryPi model.\nWarning\nRaspberryPi B+ and Zero model only\nWarning\nThis image may be change soon\ndocker pull gautric/rpi-rhiot Compile and upload Rhiot quickstart You have to compile and upload the Rhiot quickstart project to get the necessary JAR file:\ngit clone git@github.com:rhiot/quickstarts.git cd quickstarts/kura-camel git checkout kura-gpio mvn clean package and copy target/rhiot-kura-camel-1.0.0-SNAPSHOT.jar to your RaspberryPi Zero\nscp target/rhiot-kura-camel-1.0.0-SNAPSHOT.jar pi@{RPIz_IP_ADDR}: Wire, LED, RaspberryPi Follow schema below (RaspberryPi B+, 2, Zero use same pin layout)\nRun rpi-rhiot Image Now if everything goes well, we can run it via commands below:\nsudo docker run -d --privileged --cap-add=ALL \\ -v /dev:/dev \\ -v /lib/modules:/lib/modules \\ -v `pwd`:/opt/rhiot/plugins \\ -p 80:80 \\ -t rpi-rhiot ## or gautric/rpi-rhiot You can change -d to -i to run image into interactive mode.\nstart_kura_rhiot.sh script (into Dockerfile) injects all pwd/*.jar into Kura config.ini file. Kura platform will include them into the boot time.\nNow, you can use and deploy Kura Platform as you want.\nJust connect to Kura Web admin console via http://RPIz_IP_ADDR/kura. You can manage some Kura configuration (Cloud, Clock, Timer, Bundle, etc…). Change gpio id/action/period as you want.\nDebug rpi-rhiot Image If you need retrieve Rhiot Project and Kura platform log. Please use following commands:\npi@rbpiz1:~ $ sudo docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 00aa11bbccddeeff gautric/rpi-rhiot \"/bin/sh -c ${RHIOT_B\" 4 hours ago Up 4 hours 0.0.0.0:80-\u003e80/tcp, 5002/tcp jolly_almeida pi@rbpiz1:~ $ sudo docker logs -f 00aa11bbccddeeff VIDEO NB Even if we are running Kura Platform into Docker env, we use extra Docker parameters to access to low level Memory and RaspberryPi API (like GPIO in this sample). I2C and SPI should work too. Stay tuned !!!\nConclusion Now, you can use Rhiot Project over Kura OSGi Platform into Docker environment as you want, you can call low level api directly. Both development and deployment will be accelerated by using this kind of tech/idea. Docker project proves one more time its flexibility and robustness applied into IoT universe. I think Kura platform could use it for its own development and strategy. Rhiot project’s team is already convinced about it ;-)\nPlease feel free to send me your feedback below or via Apropos or via Contact form.\nUseful links Rhiot quickstart (kura-gpio branch) Hypriot get physical Kura Eclipse Platform documentation Docker documentation Rhiot project ",
  "wordCount" : "907",
  "inLanguage": "en",
  "datePublished": "2015-12-28T14:00:00Z",
  "dateModified": "2015-12-28T14:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://gautric.github.io/blog/2015/12/28/rhiot-over-kura-over-docker-over-raspberrypi-/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Greg. I/O",
    "logo": {
      "@type": "ImageObject",
      "url": "https://gautric.github.io/apple-icon-180x180.png"
    }
  }
}
</script>
</head>

<body class="" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://gautric.github.io/" accesskey="h" title="Greg. I/O (Alt + H)">
                <img src="https://gautric.github.io/apple-icon-180x180.png" alt="" aria-label="logo"
                    height="35">Greg. I/O</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://gautric.github.io/apropos/" title="À Propos">
                    <span>À Propos</span>
                </a>
            </li>
            <li>
                <a href="https://gautric.github.io/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://gautric.github.io/contact/" title="Contact">
                    <span>Contact</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://gautric.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://gautric.github.io/blog/">Blog</a></div>
    <h1 class="post-title entry-hint-parent">
      Rhiot over Kura over Docker over RaspberryPi ;-)
    </h1>
    <div class="post-meta"><span title='2015-12-28 14:00:00 +0000 UTC'>December 28, 2015</span>

</div>
  </header> 
  <div class="post-content"><p>During this cool Christmas day, Santa Claus brings us lot of presents (I hope for you too), I received 2 <a href="https://www.raspberrypi.org/blog/raspberry-pi-zero/">RaspberryPi Zero</a>, Thx you brother ;-). I will show you a cool stuff after this special day. We gonna test how to use <a href="http://rhiot.io">Rhiot project</a> into <a href="https://eclipse.org/kura/">Kura Eclipse Platform</a> running inside <a href="https://docker.com">Docker</a> container deployed into a real <a href="https://www.raspberrypi.org/blog/raspberry-pi-zero/">RaspberryPi Zero</a> device (in this order). If you don&rsquo;t have yet a RaspberryPi (B+, 2 or zero) device you can use <a href="/blog/2015/12/23/kura-OSGi-docker-debian.html">my previous post</a>.</p>
<p>In this post we will see how to integrate multiple IoT technologies in a layered approach, combining the power of Rhiot&rsquo;s IoT capabilities with Kura&rsquo;s OSGi-based platform, all containerized with Docker and running on the compact RaspberryPi hardware.</p>
<blockquote>
<p>How to use Rhiot/Kura into Docker/RaspberryPi</p></blockquote>
<h2 id="requisites">Requisites<a hidden class="anchor" aria-hidden="true" href="#requisites">#</a></h2>
<ul>
<li><a href="https://www.raspberrypi.org/">RaspberryPi</a> device
<ul>
<li>tested with Zero and B+ models</li>
<li>for other models you have to rebuilt docker image</li>
</ul>
</li>
<li><a href="https://docker.com">Docker</a> installation into Raspbian/Jessie or directly with <a href="http://blog.hypriot.com/downloads/">Hypriot</a>
<ul>
<li>tested with both of these OS</li>
</ul>
</li>
<li>Two LED</li>
<li>Two Resistor 220Ω</li>
<li>Wires</li>
<li>USB to Serial Cable
<ul>
<li>RaspberryPi Zero doesn&rsquo;t have too many ports</li>
<li>I used <a href="https://www.adafruit.com/product/954">PL-2303 USB-to-Serial Bridge Controller</a></li>
</ul>
</li>
</ul>
<h2 id="docker">Docker<a hidden class="anchor" aria-hidden="true" href="#docker">#</a></h2>
<h3 id="docker-setup">Docker setup<a hidden class="anchor" aria-hidden="true" href="#docker-setup">#</a></h3>
<p>First of all, you have to startup your Docker environment.
I prefer use <code>Hypriot</code> because Docker is already installed. <a href="http://blog.hypriot.com/getting-started-with-docker-and-linux-on-the-raspberry-pi/">More information to install Hypriot</a></p>
<p>If docker is not yet installed (Raspbian/Jessie Only):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget http://downloads.hypriot.com/docker-hypriot_1.9.1-1_armhf.deb
</span></span><span class="line"><span class="cl">sudo dpkg -i docker-hypriot_1.9.1-1_armhf.deb
</span></span></code></pre></div><p>If docker is not started:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo service docker start
</span></span></code></pre></div><h3 id="build-rpi-rhiot-image-and-take-a-coffee-">Build rpi-rhiot Image and take a coffee &hellip;<a hidden class="anchor" aria-hidden="true" href="#build-rpi-rhiot-image-and-take-a-coffee-">#</a></h3>
<p>We gonna download docker file, and run correct command to built it.</p>
<div><svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg"><symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/></symbol><symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet"><path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/></symbol></svg></div><div class="notice warning" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#warning-notice"></use></svg></span>Warning</p><p>Please change RPI_VERSION with your correct RaspberryPi model</p></div>

<p><code>RPI_VERSION</code> must be: <code>raspberry-pi-2-nn</code> or <code>raspberry-pi-bplus-nn</code> or <code>raspberry-pi-nn</code>. <code>nn</code> means Kura will not include network management (firewall, port, etc&hellip;), keep it cause we can ignore network management for a Docker environment.</p>
<script src="https://gist.github.com/gautric/dbe4684a6b17186afe42.js"></script>
<p>We download some helper scripts and files to prepare our Docker build environment:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir rpi-rhiot
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> rpi-rhiot
</span></span><span class="line"><span class="cl">curl https://gist.githubusercontent.com/gautric/dbe4684a6b17186afe42/raw/4aa24e22016e49b0982264845b7fe7e0311a3952/Dockerfile -O
</span></span><span class="line"><span class="cl">curl https://raw.githubusercontent.com/rhiot/rhiot/master/dockerfiles/rpi-rhiot/config.ini.sh -O
</span></span><span class="line"><span class="cl">curl https://raw.githubusercontent.com/rhiot/rhiot/master/dockerfiles/rpi-rhiot/log4j.properties -O
</span></span><span class="line"><span class="cl">curl https://raw.githubusercontent.com/rhiot/rhiot/master/dockerfiles/rpi-rhiot/start_kura_rhiot.sh -O
</span></span><span class="line"><span class="cl">sudo docker build -t rpi-rhiot .
</span></span></code></pre></div><p>Just build it via commands above</p>
<p><strong>Now it is coffee time, let&rsquo;s build docker image</strong></p>
<p>You should get an output like this after a while to compile Rhiot Docker image.</p>
<pre tabindex="0"><code>pi@rbpiz1:~/rpi-rhiot $ sudo docker build -t rpi-rhiot .
Sending build context to Docker daemon 12.29 kB
Step 1 : FROM resin/rpi-raspbian:jessie
 ---&gt; e97a8531a526
Step 2 : MAINTAINER Greg AUTRIC &lt;gautric@redhat.com&gt;
 ---&gt; Using cache
 ---&gt; 9f6d3dedf04a
Step 3 : ENV CAMEL_VERSION ${CAMEL_VERSION:-2.16.1}
 ---&gt; Using cache
 ---&gt; 5695c4034847
Step 4 : ENV RHIOT_VERSION ${RHIOT_VERSION:-0.1.3}
 ---&gt; Using cache
 ---&gt; 91fb37b40966
Step 5 : ENV JAVA_VERSION ${JAVA_VERSION:-7}
 ---&gt; Using cache
 ---&gt; 5ce6f2fd7edd
Step 6 : ENV KURA_VERSION ${KURA_VERSION:-1.3.0}
 ---&gt; Using cache
 ---&gt; 413de7f8e993
Step 7 : ENV RPI_VERSION ${RPI_VERSION:-raspberry-pi-bplus-nn}
 ---&gt; Using cache
 ---&gt; a584f9145729

... OMIT ...

Step 32 : RUN ${RHIOT_BIN_FOLDER}/config.ini.sh
 ---&gt; Using cache
 ---&gt; 14deb381475f
Step 33 : EXPOSE 80
 ---&gt; Using cache
 ---&gt; b5dc47bd7f51
Step 34 : EXPOSE 5002
 ---&gt; Using cache
 ---&gt; c95b9d1593bc
Step 35 : CMD ${RHIOT_BIN_FOLDER}/start_kura_rhiot.sh
 ---&gt; Using cache
 ---&gt; 4d0e0a16f2c8
Successfully built 4d0e0a16f2c8
</code></pre><h3 id="or-pull-rpi-rhiot-image-and-take-a-coffee-too">or Pull rpi-rhiot Image and take a coffee too<a hidden class="anchor" aria-hidden="true" href="#or-pull-rpi-rhiot-image-and-take-a-coffee-too">#</a></h3>
<p>An other option is to pull image I&rsquo;ve already built and pushed to Docker Hub. This can save you significant build time if you&rsquo;re using a compatible RaspberryPi model.</p>
<p><div class="notice warning" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#warning-notice"></use></svg></span>Warning</p><p>RaspberryPi B+ and Zero model only</p></div>

<div class="notice warning" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#warning-notice"></use></svg></span>Warning</p><p>This image may be change soon</p></div>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker pull gautric/rpi-rhiot
</span></span></code></pre></div><h2 id="compile-and-upload-rhiot-quickstart">Compile and upload Rhiot quickstart<a hidden class="anchor" aria-hidden="true" href="#compile-and-upload-rhiot-quickstart">#</a></h2>
<p>You have to compile and upload the Rhiot quickstart project to get the necessary JAR file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone git@github.com:rhiot/quickstarts.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> quickstarts/kura-camel
</span></span><span class="line"><span class="cl">git checkout kura-gpio
</span></span><span class="line"><span class="cl">mvn clean package
</span></span></code></pre></div><p>and copy <code>target/rhiot-kura-camel-1.0.0-SNAPSHOT.jar</code> to your RaspberryPi Zero</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">scp target/rhiot-kura-camel-1.0.0-SNAPSHOT.jar pi@<span class="o">{</span>RPIz_IP_ADDR<span class="o">}</span>:
</span></span></code></pre></div><h3 id="wire-led-raspberrypi">Wire, LED, RaspberryPi<a hidden class="anchor" aria-hidden="true" href="#wire-led-raspberrypi">#</a></h3>
<p>Follow schema below <em>(RaspberryPi B+, 2, Zero use same pin layout)</em></p>
<img src="/img/kura-camel-rhiot-8.png" style="max-width:80%;" />
<h2 id="run-rpi-rhiot-image">Run rpi-rhiot Image<a hidden class="anchor" aria-hidden="true" href="#run-rpi-rhiot-image">#</a></h2>
<p>Now if everything goes well, we can run it via commands below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo docker run -d --privileged --cap-add<span class="o">=</span>ALL <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>           -v /dev:/dev <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>           -v /lib/modules:/lib/modules <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>           -v <span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>:/opt/rhiot/plugins <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>           -p 80:80 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>           -t rpi-rhiot                       <span class="c1">## or gautric/rpi-rhiot</span>
</span></span></code></pre></div><p>You can change <code>-d</code> to <code>-i</code> to run image into interactive mode.</p>
<p><code>start_kura_rhiot.sh</code> script (into Dockerfile) injects all <strong><code>pwd</code>/*.jar</strong> into Kura <code>config.ini</code> file.
Kura platform will include them into the boot time.</p>
<p>Now, you can use and deploy Kura Platform as you want.</p>
<p>Just connect to Kura Web admin console via <a href="http://RPIz_IP_ADDR/kura">http://RPIz_IP_ADDR/kura</a>. You can manage some Kura configuration (Cloud, Clock, Timer, Bundle, etc&hellip;).
Change gpio id/action/period as you want.</p>
<img src="/img/docker-rhiot.png" width="75%" height="66%" />
<h2 id="debug-rpi-rhiot-image">Debug rpi-rhiot Image<a hidden class="anchor" aria-hidden="true" href="#debug-rpi-rhiot-image">#</a></h2>
<p>If you need retrieve Rhiot Project and Kura platform log.
Please use following commands:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@rbpiz1:~ $ sudo docker ps
</span></span><span class="line"><span class="cl">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                          NAMES
</span></span><span class="line"><span class="cl">00aa11bbccddeeff        gautric/rpi-rhiot   <span class="s2">&#34;/bin/sh -c </span><span class="si">${</span><span class="nv">RHIOT_B</span><span class="s2">&#34;   4 hours ago         Up 4 hours          0.0.0.0:80-&gt;80/tcp, 5002/tcp   jolly_almeida
</span></span></span><span class="line"><span class="cl"><span class="s2">pi@rbpiz1:~ </span>$<span class="s2"> sudo docker logs -f 00aa11bbccddeeff
</span></span></span></code></pre></div><h2 id="video">VIDEO<a hidden class="anchor" aria-hidden="true" href="#video">#</a></h2>
<iframe width="650" height="415" src="https://www.youtube.com/embed/NXNyk9wlWmg" frameborder="0" ></iframe>
<h3 id="nb">NB<a hidden class="anchor" aria-hidden="true" href="#nb">#</a></h3>
<p>Even if we are running Kura Platform into Docker env, we use extra Docker parameters to access to low level Memory and RaspberryPi API (like GPIO in this sample). I2C and SPI should work too. Stay tuned !!!</p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>Now, you can use <strong>Rhiot Project</strong> over <strong>Kura OSGi Platform</strong> into <strong>Docker</strong> environment as you want, you can call low level api directly. Both development and deployment will be accelerated by using this kind of tech/idea.
<a href="https://docker.com/">Docker</a> project proves one more time its flexibility and robustness applied into IoT universe. I think <a href="http://eclipse.github.io/kura/">Kura platform</a> could use it for its own development and strategy. <a href="http://rhiot.io">Rhiot project</a>&rsquo;s team is already convinced about it ;-)</p>
<p>Please feel free to send me your feedback below or via <a href="/apropos/">Apropos</a> or via <a href="/contact/">Contact form</a>.</p>
<h3 id="useful-links">Useful links<a hidden class="anchor" aria-hidden="true" href="#useful-links">#</a></h3>
<ul>
<li><a href="https://github.com/rhiot/quickstarts/tree/kura-gpio/kura-camel">Rhiot quickstart (kura-gpio branch)</a></li>
<li><a href="http://blog.hypriot.com/post/lets-get-physical/">Hypriot get physical</a></li>
<li><a href="http://eclipse.github.io/kura/">Kura Eclipse Platform documentation</a></li>
<li><a href="https://docs.docker.com/">Docker documentation</a></li>
<li><a href="http://rhiot.io">Rhiot project</a></li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://gautric.github.io/tags/en/">En</a></li>
      <li><a href="https://gautric.github.io/tags/rhiot/">Rhiot</a></li>
      <li><a href="https://gautric.github.io/tags/kura/">Kura</a></li>
      <li><a href="https://gautric.github.io/tags/docker/">Docker</a></li>
      <li><a href="https://gautric.github.io/tags/raspberrypi/">RaspberryPi</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://gautric.github.io/blog/2016/01/29/unesco-challenge-point-unesco-maritime-greenwich-prime-meridian/">
    <span class="title">« Prev</span>
    <br>
    <span>UNESCO Challenge, point UNESCO, Maritime Greenwich, Prime Meridian</span>
  </a>
  <a class="next" href="https://gautric.github.io/blog/2015/12/23/kura-over-docker/">
    <span class="title">Next »</span>
    <br>
    <span>Kura over Docker</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2016 - 2025 <a href="https://gautric.github.io/">Greg. I/O</a></span>
    
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
</body>

</html>
