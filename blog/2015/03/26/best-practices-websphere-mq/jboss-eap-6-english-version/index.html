<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Best Practices Websphere MQ/JBoss EAP 6 English Version | Greg. I/O</title>
<meta name="keywords" content="en, jboss, eap, wildfly, websphereMQ, JCA">
<meta name="description" content="JBoss EAP application server is Java EE 6 certified, it implements via IronJacamar framework, the Java EE Connector Architecture (JCA) standard. This standard provides connection ability for Java EE applications to interact with external data system like JMS broker, file system or mainframe. The JCA standard is similar to the JDBC standard. The latter interacts only with relational databases but JCA can interact with more data system providers and it can integrate different kinds of Enterprise Information System (EIS).">
<meta name="author" content="">
<link rel="canonical" href="https://gautric.github.io/blog/2015/03/26/best-practices-websphere-mq/jboss-eap-6-english-version/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.26cca5596cf53898626a540511b92ee26f2bfa182bb8ac88d95536b8581f7899.css" integrity="sha256-JsylWWz1OJhialQFEbku4m8r&#43;hgruKyI2VU2uFgfeJk=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://gautric.github.io/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://gautric.github.io/android-icon-36x36.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://gautric.github.io/android-icon-36x36.png">
<link rel="apple-touch-icon" href="https://gautric.github.io/apple-icon-180x180.png">
<link rel="mask-icon" href="https://gautric.github.io/apple-icon-180x180.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://gautric.github.io/blog/2015/03/26/best-practices-websphere-mq/jboss-eap-6-english-version/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="Best Practices Websphere MQ/JBoss EAP 6 English Version" />
<meta property="og:description" content="JBoss EAP application server is Java EE 6 certified, it implements via IronJacamar framework, the Java EE Connector Architecture (JCA) standard. This standard provides connection ability for Java EE applications to interact with external data system like JMS broker, file system or mainframe. The JCA standard is similar to the JDBC standard. The latter interacts only with relational databases but JCA can interact with more data system providers and it can integrate different kinds of Enterprise Information System (EIS)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://gautric.github.io/blog/2015/03/26/best-practices-websphere-mq/jboss-eap-6-english-version/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-03-26T13:58:00+00:00" />
<meta property="article:modified_time" content="2015-03-26T13:58:00+00:00" /><meta property="og:site_name" content="Greg. I/O" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Best Practices Websphere MQ/JBoss EAP 6 English Version"/>
<meta name="twitter:description" content="JBoss EAP application server is Java EE 6 certified, it implements via IronJacamar framework, the Java EE Connector Architecture (JCA) standard. This standard provides connection ability for Java EE applications to interact with external data system like JMS broker, file system or mainframe. The JCA standard is similar to the JDBC standard. The latter interacts only with relational databases but JCA can interact with more data system providers and it can integrate different kinds of Enterprise Information System (EIS)."/>
<meta name="twitter:site" content="@gautric_io"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Blog",
      "item": "https://gautric.github.io/blog/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Best Practices Websphere MQ/JBoss EAP 6 English Version",
      "item": "https://gautric.github.io/blog/2015/03/26/best-practices-websphere-mq/jboss-eap-6-english-version/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Best Practices Websphere MQ/JBoss EAP 6 English Version",
  "name": "Best Practices Websphere MQ\/JBoss EAP 6 English Version",
  "description": "JBoss EAP application server is Java EE 6 certified, it implements via IronJacamar framework, the Java EE Connector Architecture (JCA) standard. This standard provides connection ability for Java EE applications to interact with external data system like JMS broker, file system or mainframe. The JCA standard is similar to the JDBC standard. The latter interacts only with relational databases but JCA can interact with more data system providers and it can integrate different kinds of Enterprise Information System (EIS).\n",
  "keywords": [
    "en", "jboss", "eap", "wildfly", "websphereMQ", "JCA"
  ],
  "articleBody": "JBoss EAP application server is Java EE 6 certified, it implements via IronJacamar framework, the Java EE Connector Architecture (JCA) standard. This standard provides connection ability for Java EE applications to interact with external data system like JMS broker, file system or mainframe. The JCA standard is similar to the JDBC standard. The latter interacts only with relational databases but JCA can interact with more data system providers and it can integrate different kinds of Enterprise Information System (EIS).\nJCA standard manages severals features like :\nSystem connection (socket, IPC, …) Transactions management (locales, XA) Security management and user access Life cycle and thread management Service provider supplies to developer or integrator a JCA driver a.k.a : Resource Adapter\nGoal of this post :\nBest practices for integrating WebSphere MQ (WMQ) with JBoss EAP 6 (JEAP)\nPrerequisites For this lab, you need the following software :\na JBoss EAP instance http://www.jboss.org/products/eap/download/ a WebSphereMQ server http://www.ibm.com/developerworks/downloads/ws/wmq/ WMQ Resource Adapter is available here /opt/mqm/java/lib/jca Warning\nWarning, it is trial or evaluation only, production deployment requires the purchase of subscription for JBoss and license for IBM\nDevelopment In order to test our integration we need to develop a client for sending, and a MDB to receive JMS message.\nFor sending In our case we create a Stateless EJB to send the JMS message. It is possible to use another mechanism for the transmission, a servlet , for example.\n// ..OMIT .. // @Stateless public class MoMSenderBean { // ..OMIT .. // @Resource(name = \"jms/connectionFactory\") ConnectionFactory factory; @Resource(name = \"jms/queue/Queue\") Queue queue; public void sendMessage(String message) throws JMSException { Connection connection = factory.createConnection(); LOGGER.trace(\"Recuperation d'une connexion {}\", connection); Session session = connection.createSession(false, AUTO_ACKNOWLEDGE); MessageProducer producer = session.createProducer(queue); LOGGER.trace(\"Creation du sender {} sur la queue {}\", producer, queue); TextMessage textMessage = session.createTextMessage(message); textMessage.setJMSCorrelationID(UUID.randomUUID().toString()); producer.send(textMessage); producer.close(); session.close(); connection.close(); } } Note in this code, JMS resources ( Factory and Queue ) are retrieved from the scope of the current module.\nMore information about JNDI and JBoss\nFor reception In the Java EE world, to allow applications to receive JMS messages asynchronously, we must develop a special bean. This bean is a Message Driven Bean (MDB), the object is called when a message is received in the JMS queue. The class has to implement javax.jms.MessageListener interface.\n// ..OMIT .. // public class MoMMDB implements MessageListener { // ..OMIT .. // public void onMessage(Message message) { LOGGER.info(\"Received Message from queue: {}\" + (TextMessage) message); } } Of course, it’s possible to add ActivationSpec annotations to MDB, but these annotations drowns application contextual problematic (environment outside the application, WMQ server hostname / port for example) into code. With other resource adapter/system provider it could be easier (HornetQ / ActiveMQ).\nApplication configuration Now, let’s configure the application to connect MDB to the correct JMS queue. First, we will use the ejb-jar.xml file to define main objects.\nJava EE Definition (ejb-jar.xml) MoM Application EJB / MDB MoM Application EJB / MDB MoM MDB MessageDrivenBean net.a.g.jee.mom.mdb.MoMMDB Container javax.jms.Queue MoMSenderBean net.a.g.jee.mom.ejb.MoMSenderBean Specific WMQ and JBoss implementation configuration (jboss-ejb3.xml) As we want to connect MDB to a server WebSphereMQ, we have to configure several WMQ specific properties. We also map environment resources from the application server to the resources of the application.\nMessageDrivenBean net.a.g.jee.mom.mdb.MoMMDB Container javax.jms.Queue channel ${websphere.channel} queueManager ${websphere.queueManager} transportType ${websphere.transportType} hostName ${websphere.hostName} port ${websphere.port} username ${websphere.username} password ${websphere.password} destination java:/jboss/jms/wmq/queue/Queue useJNDI true destinationType javax.jms.Queue MoMSenderBean net.a.g.jee.mom.ejb.MoMSenderBean jms/connectionFactory javax.jms.ConnectionFactory java:/jboss/jms/wmq/connectionFactory jms/queue/Queue java:/jboss/jms/wmq/queue/Queue MessageDrivenBean ${websphere.resource.adapter} Important information from this xml file :\nPlaceholder in the whole of file to externalize values inside JBoss standalone.xml file hostName -\u003e ${websphere.hostName} port -\u003e ${websphere.port} queueManager -\u003e ${websphere.queueManager} useJNDI property is true to pickup the queue from JNDI context JNDI mapping name : global scope and module scope Queue name inside server setting : java:/jboss/jms/wmq/queue/Queue Queue name inside application scope : jms/queue/Queue Binding of WMQ ressource adapteur (JCA driver) with MDB bean. element Warning\nIt is recommended to use XML files in a business context. Indeed, changing environment and frequent changes often requires some information modifications (clustering integration, authentication capability for example). Java code should depend as little as possible of the environment and external systems.\nInfo\nIf application needs to interact with another JMS provider (ActiveMQ or HornetQ), just copy/paste this file and change values with correct configuration. We can switch very easily from a provider to another.\nJBoss configuration In this chapter, we will setup JBoss EAP file a.k.a standalone.xml.\nSystem properties We set all WebSphereMQ connection environment settings we’ve seen in the jboss-ejb3.xml file.\nInfo\nBINDING mode is the second transport type available to connect to WebsphereMQ, but operating-system binaries have to be installed.\nPlaceholders JBoss will use system properties to replace placeholders with correct values inside several object type.\nJBoss can manage placeholder replacements for :\nStandard Java EE descriptor files. spec-descriptor-property-replacement web.xml, ejb-jar.xml, etc… JBoss specific descriptor files. jboss-descriptor-property-replacement jboss-web.xml, jboss-ejb3.xml, etc… Annotations annotation-property-replacement false true false Note\nI prefer use replacement only for JBoss specific descriptor files. Because another application server couldn’t manage placeholder replacements inside Java EE standard descriptor files.\nWMQ connection and resource adapter configuration Finally, let’s configure the WMQ resource adapter inside JBoss instance standalone.xml.\nwmq.jmsra.rar LocalTransaction ${websphere.port:1414} ${websphere.hostName:localhost} ${websphere.username:mqm} ${websphere.password:mqm} ${websphere.channel:SYSTEM.AUTO.SVRCONN} ${websphere.transportType:CLIENT} ${websphere.queueManager:QUEUE.MANAGER} ${websphere.queueManager:QUEUE.MANAGER} ${websphere.queueName:Q_QUEUE} Info\nYou will notice we are still using placeholders into this part of JBoss configuration file.\nPut the Websphere MQ resource adapter wmq.jmsra.rar and your application into JBoss instance deployment directory ${JBOSS_HOME}/standalone/deployments.\nEt voilà ;-)\nConclusion Integrating WebSphereMQ resource adapter is an easy operation on the JBoss application server. If you follow the general ideas in this post, it is possible to obtain a modular and easy application to maintain. Deploying your app in different environments (DEV , INT, PROD) is simplified, and only system properties in standalone.xml file should be changed.\nURL https://access.redhat.com/documentation/en-US/JBoss_Enterprise_Application_Platform/6/html/Administration_and_Configuration_Guide/Deploy_the_WebSphere_MQ_Resource_Adapter.html https://developer.jboss.org/message/738670 https://developer.jboss.org/wiki/WebsphereMQIntegration The installation verification test program for the WebSphere MQ resource adapter French version Thanks Akram B. A. @RedHat for resources Guillaume C. @RedHat for advices Jean-Yves C. for corrections ",
  "wordCount" : "1124",
  "inLanguage": "en",
  "datePublished": "2015-03-26T13:58:00Z",
  "dateModified": "2015-03-26T13:58:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://gautric.github.io/blog/2015/03/26/best-practices-websphere-mq/jboss-eap-6-english-version/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Greg. I/O",
    "logo": {
      "@type": "ImageObject",
      "url": "https://gautric.github.io/apple-icon-180x180.png"
    }
  }
}
</script>
</head>

<body class="" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://gautric.github.io/" accesskey="h" title="Greg. I/O (Alt + H)">
                <img src="https://gautric.github.io/apple-icon-180x180.png" alt="" aria-label="logo"
                    height="35">Greg. I/O</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://gautric.github.io/apropos/" title="À Propos">
                    <span>À Propos</span>
                </a>
            </li>
            <li>
                <a href="https://gautric.github.io/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://gautric.github.io/contact/" title="Contact">
                    <span>Contact</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://gautric.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://gautric.github.io/blog/">Blog</a></div>
    <h1 class="post-title entry-hint-parent">
      Best Practices Websphere MQ/JBoss EAP 6 English Version
    </h1>
    <div class="post-meta"><span title='2015-03-26 13:58:00 +0000 UTC'>March 26, 2015</span>

</div>
  </header> 
  <div class="post-content"><p><a href="http://www.jboss.org/products/eap/overview/">JBoss EAP</a> application server is <a href="http://www.oracle.com/technetwork/java/javaee/overview/compatibility-jsp-136984.html">Java EE 6 certified</a>, it implements via <a href="http://www.ironjacamar.org/">IronJacamar</a> framework, the Java EE Connector Architecture (JCA) standard. This standard provides connection ability for Java EE applications to interact with external data system like JMS broker, file system or mainframe. The JCA standard is similar to the JDBC standard. The latter interacts only with relational databases but JCA can interact with more data system providers and it can integrate different kinds of Enterprise Information System (EIS).</p>
<p>JCA standard manages severals features like :</p>
<ul>
<li>System connection (socket, IPC, &hellip;)</li>
<li>Transactions management (locales, XA)</li>
<li>Security management and user access</li>
<li>Life cycle and thread management</li>
</ul>
<p>Service provider supplies to developer or integrator a JCA driver a.k.a : <a href="http://docs.oracle.com/javaee/6/tutorial/doc/gipgl.html">Resource Adapter</a></p>
<p>Goal of this post :</p>
<blockquote>
<p>Best practices for integrating WebSphere MQ (WMQ) with JBoss EAP 6 (JEAP)</p></blockquote>
<h1 id="prerequisites">Prerequisites<a hidden class="anchor" aria-hidden="true" href="#prerequisites">#</a></h1>
<p>For this lab, you need the following software :</p>
<ul>
<li>a JBoss EAP instance <a href="http://www.jboss.org/products/eap/download/">http://www.jboss.org/products/eap/download/</a></li>
<li>a WebSphereMQ server <a href="http://www.ibm.com/developerworks/downloads/ws/wmq/">http://www.ibm.com/developerworks/downloads/ws/wmq/</a>
<ul>
<li>WMQ Resource Adapter is available here <strong>/opt/mqm/java/lib/jca</strong></li>
</ul>
</li>
</ul>
<div><svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg"><symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/></symbol><symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet"><path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/></symbol></svg></div><div class="notice warning" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#warning-notice"></use></svg></span>Warning</p><p>Warning, it is trial or evaluation only, production deployment requires the purchase of subscription for JBoss and license for IBM</p></div>

<h1 id="development">Development<a hidden class="anchor" aria-hidden="true" href="#development">#</a></h1>
<p>In order to test our integration we need to develop a client for sending, and a MDB to receive JMS message.</p>
<h2 id="for-sending">For sending<a hidden class="anchor" aria-hidden="true" href="#for-sending">#</a></h2>
<p>In our case we create a Stateless EJB to send the JMS message. It is possible to use another mechanism for the transmission, a servlet , for example.</p>
<pre tabindex="0"><code>// ..OMIT .. //

@Stateless
public class MoMSenderBean {

  // ..OMIT .. //

	@Resource(name = &#34;jms/connectionFactory&#34;)
	ConnectionFactory factory;

	@Resource(name = &#34;jms/queue/Queue&#34;)
	Queue queue;

	public void sendMessage(String message) throws JMSException {

            Connection connection = factory.createConnection();
            LOGGER.trace(&#34;Recuperation d&#39;une connexion {}&#34;, connection);

            Session session = connection.createSession(false, AUTO_ACKNOWLEDGE);
            MessageProducer producer = session.createProducer(queue);
            LOGGER.trace(&#34;Creation du sender {} sur la queue {}&#34;, producer, queue);

            TextMessage textMessage = session.createTextMessage(message);
            textMessage.setJMSCorrelationID(UUID.randomUUID().toString());
            producer.send(textMessage);
            producer.close();
            session.close();
            connection.close();
	}
}
</code></pre><div class="notice notice" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#notice-notice"></use></svg></span></p><p>Note in this code, JMS resources ( Factory and Queue ) are retrieved from the scope of the current module.</p></div>

<p>More information about <a href="https://docs.jboss.org/author/display/AS72/JNDI+Reference">JNDI and JBoss</a></p>
<h2 id="for-reception">For reception<a hidden class="anchor" aria-hidden="true" href="#for-reception">#</a></h2>
<p>In the Java EE world, to allow applications to receive JMS messages asynchronously, we must develop a special bean. This bean is a Message Driven Bean (MDB), the object is called when a message is received in the JMS queue. The class has to implement <strong>javax.jms.MessageListener</strong> interface.</p>
<pre tabindex="0"><code>// ..OMIT .. //

public class MoMMDB implements MessageListener {

  // ..OMIT .. //

	public void onMessage(Message message) {
		LOGGER.info(&#34;Received Message from queue: {}&#34; + (TextMessage) message);

	}
}
</code></pre><div class="notice notice" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#notice-notice"></use></svg></span></p><p>Of course, it&rsquo;s possible to add ActivationSpec annotations to MDB, but these annotations drowns application contextual problematic  (environment outside the application, WMQ server hostname / port for example) into code. With other resource adapter/system provider it could be easier (HornetQ / ActiveMQ).</p></div>

<h1 id="application-configuration">Application configuration<a hidden class="anchor" aria-hidden="true" href="#application-configuration">#</a></h1>
<p>Now, let&rsquo;s configure the application to connect MDB to the correct JMS queue. First, we will use the <strong>ejb-jar.xml</strong> file to define main objects.</p>
<h2 id="java-ee-definition-ejb-jarxml">Java EE Definition (ejb-jar.xml)<a hidden class="anchor" aria-hidden="true" href="#java-ee-definition-ejb-jarxml">#</a></h2>
<pre tabindex="0"><code>  &lt;ejb-jar xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xmlns=&#34;http://java.sun.com/xml/ns/javaee&#34; xsi:schemaLocation=&#34;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/ejb-jar_3_0.xsd&#34; version=&#34;3.0&#34;&gt;
    &lt;description&gt;MoM Application EJB / MDB &lt;/description&gt;
    &lt;display-name&gt;MoM Application EJB / MDB&lt;/display-name&gt;
    &lt;enterprise-beans&gt;
      &lt;message-driven&gt;
        &lt;description&gt;MoM MDB&lt;/description&gt;
        &lt;ejb-name&gt;MessageDrivenBean&lt;/ejb-name&gt;
        &lt;ejb-class&gt;net.a.g.jee.mom.mdb.MoMMDB&lt;/ejb-class&gt;
        &lt;transaction-type&gt;Container&lt;/transaction-type&gt;
        &lt;message-destination-type&gt;javax.jms.Queue&lt;/message-destination-type&gt;
      &lt;/message-driven&gt;
      &lt;session&gt;
        &lt;ejb-name&gt;MoMSenderBean&lt;/ejb-name&gt;
        &lt;ejb-class&gt;net.a.g.jee.mom.ejb.MoMSenderBean&lt;/ejb-class&gt;
      &lt;/session&gt;
    &lt;/enterprise-beans&gt;
  &lt;/ejb-jar&gt;
</code></pre><h2 id="specific-wmq-and-jboss-implementation-configuration-jboss-ejb3xml">Specific WMQ and JBoss implementation configuration (jboss-ejb3.xml)<a hidden class="anchor" aria-hidden="true" href="#specific-wmq-and-jboss-implementation-configuration-jboss-ejb3xml">#</a></h2>
<p>As we want to connect MDB to a server WebSphereMQ, we have to configure several WMQ specific properties. We also map environment resources from the application server to the resources of the application.</p>
<pre tabindex="0"><code>&lt;jboss:ejb-jar xmlns:jboss=&#34;http://www.jboss.com/xml/ns/javaee&#34;
  xmlns=&#34;http://java.sun.com/xml/ns/javaee&#34; xmlns:jee=&#34;http://java.sun.com/xml/ns/javaee&#34;
  xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xmlns:mdb=&#34;urn:resource-adapter-binding&#34;
  xsi:schemaLocation=&#34;http://www.jboss.com/xml/ns/javaee http://www.jboss.org/j2ee/schema/jboss-ejb3-2_0.xsd http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/ejb-jar_3_1.xsd&#34;
  version=&#34;3.1&#34; impl-version=&#34;2.0&#34;&gt;
  &lt;jee:enterprise-beans&gt;
    &lt;jee:message-driven&gt;
      &lt;jee:ejb-name&gt;MessageDrivenBean&lt;/jee:ejb-name&gt;
      &lt;jee:ejb-class&gt;net.a.g.jee.mom.mdb.MoMMDB&lt;/jee:ejb-class&gt;
      &lt;jee:transaction-type&gt;Container&lt;/jee:transaction-type&gt;
      &lt;jee:message-destination-type&gt;javax.jms.Queue&lt;/jee:message-destination-type&gt;
      &lt;jee:activation-config&gt;
        &lt;jee:activation-config-property&gt;
          &lt;jee:activation-config-property-name&gt;channel&lt;/jee:activation-config-property-name&gt;
          &lt;jee:activation-config-property-value&gt;${websphere.channel}&lt;/jee:activation-config-property-value&gt;
        &lt;/jee:activation-config-property&gt;
        &lt;jee:activation-config-property&gt;
          &lt;jee:activation-config-property-name&gt;queueManager&lt;/jee:activation-config-property-name&gt;
          &lt;jee:activation-config-property-value&gt;${websphere.queueManager}&lt;/jee:activation-config-property-value&gt;
        &lt;/jee:activation-config-property&gt;
        &lt;jee:activation-config-property&gt;
          &lt;jee:activation-config-property-name&gt;transportType&lt;/jee:activation-config-property-name&gt;
          &lt;jee:activation-config-property-value&gt;${websphere.transportType}&lt;/jee:activation-config-property-value&gt;
        &lt;/jee:activation-config-property&gt;
        &lt;jee:activation-config-property&gt;
          &lt;jee:activation-config-property-name&gt;hostName&lt;/jee:activation-config-property-name&gt;
          &lt;jee:activation-config-property-value&gt;${websphere.hostName}&lt;/jee:activation-config-property-value&gt;
        &lt;/jee:activation-config-property&gt;
        &lt;jee:activation-config-property&gt;
          &lt;jee:activation-config-property-name&gt;port&lt;/jee:activation-config-property-name&gt;
          &lt;jee:activation-config-property-value&gt;${websphere.port}&lt;/jee:activation-config-property-value&gt;
        &lt;/jee:activation-config-property&gt;
        &lt;jee:activation-config-property&gt;
          &lt;jee:activation-config-property-name&gt;username&lt;/jee:activation-config-property-name&gt;
          &lt;jee:activation-config-property-value&gt;${websphere.username}&lt;/jee:activation-config-property-value&gt;
        &lt;/jee:activation-config-property&gt;
        &lt;jee:activation-config-property&gt;
          &lt;jee:activation-config-property-name&gt;password&lt;/jee:activation-config-property-name&gt;
          &lt;jee:activation-config-property-value&gt;${websphere.password}&lt;/jee:activation-config-property-value&gt;
        &lt;/jee:activation-config-property&gt;
        &lt;jee:activation-config-property&gt;
          &lt;jee:activation-config-property-name&gt;destination&lt;/jee:activation-config-property-name&gt;
          &lt;jee:activation-config-property-value&gt;java:/jboss/jms/wmq/queue/Queue&lt;/jee:activation-config-property-value&gt;
        &lt;/jee:activation-config-property&gt;
        &lt;jee:activation-config-property&gt;
          &lt;jee:activation-config-property-name&gt;useJNDI&lt;/jee:activation-config-property-name&gt;
          &lt;jee:activation-config-property-value&gt;true&lt;/jee:activation-config-property-value&gt;
        &lt;/jee:activation-config-property&gt;
        &lt;jee:activation-config-property&gt;
          &lt;jee:activation-config-property-name&gt;destinationType&lt;/jee:activation-config-property-name&gt;
          &lt;jee:activation-config-property-value&gt;javax.jms.Queue&lt;/jee:activation-config-property-value&gt;
        &lt;/jee:activation-config-property&gt;
      &lt;/jee:activation-config&gt;
    &lt;/jee:message-driven&gt;
    &lt;jee:session&gt;
      &lt;jee:ejb-name&gt;MoMSenderBean&lt;/jee:ejb-name&gt;
      &lt;jee:ejb-class&gt;net.a.g.jee.mom.ejb.MoMSenderBean&lt;/jee:ejb-class&gt;
      &lt;jee:resource-ref&gt;
        &lt;jee:res-ref-name&gt;jms/connectionFactory&lt;/jee:res-ref-name&gt;
        &lt;jee:res-type&gt;javax.jms.ConnectionFactory&lt;/jee:res-type&gt;
        &lt;jee:lookup-name&gt;java:/jboss/jms/wmq/connectionFactory&lt;/jee:lookup-name&gt;
      &lt;/jee:resource-ref&gt;
      &lt;jee:resource-env-ref&gt;
        &lt;jee:resource-env-ref-name&gt;jms/queue/Queue&lt;/jee:resource-env-ref-name&gt;
        &lt;jee:lookup-name&gt;java:/jboss/jms/wmq/queue/Queue&lt;/jee:lookup-name&gt;
      &lt;/jee:resource-env-ref&gt;
    &lt;/jee:session&gt;
  &lt;/jee:enterprise-beans&gt;
  &lt;jee:assembly-descriptor&gt;
    &lt;mdb:resource-adapter-binding&gt;
      &lt;jee:ejb-name&gt;MessageDrivenBean&lt;/jee:ejb-name&gt;
      &lt;mdb:resource-adapter-name&gt;${websphere.resource.adapter}&lt;/mdb:resource-adapter-name&gt;
    &lt;/mdb:resource-adapter-binding&gt;
  &lt;/jee:assembly-descriptor&gt;
&lt;/jboss:ejb-jar&gt;
</code></pre><p>Important information from this xml file :</p>
<ul>
<li>Placeholder in the whole of file to externalize values inside JBoss <strong>standalone.xml</strong> file
<ul>
<li><strong>hostName</strong>     -&gt; <strong>${websphere.hostName}</strong></li>
<li><strong>port</strong>         -&gt; <strong>${websphere.port}</strong></li>
<li><strong>queueManager</strong> -&gt; <strong>${websphere.queueManager}</strong></li>
</ul>
</li>
<li><strong>useJNDI</strong> property is true to pickup the queue from JNDI context</li>
<li>JNDI mapping name : global scope and module scope
<ul>
<li>Queue name inside server setting  : <strong>java:/jboss/jms/wmq/queue/Queue</strong></li>
<li>Queue name inside application scope : <strong>jms/queue/Queue</strong></li>
</ul>
</li>
<li>Binding of WMQ ressource adapteur (JCA driver) with  MDB bean.
<ul>
<li><strong>&lt;mdb:resource-adapter-binding&gt;</strong> element</li>
</ul>
</li>
</ul>
<div class="notice warning" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#warning-notice"></use></svg></span>Warning</p><p>It is recommended to use XML files in a business context. Indeed, changing environment and frequent changes often requires some information modifications (clustering integration, authentication capability for example). Java code should depend as little as possible of the environment and external systems.</p></div>

<div class="notice info" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#info-notice"></use></svg></span>Info</p><p>If application needs to interact with another JMS provider (ActiveMQ or HornetQ), just copy/paste this file and change values with correct configuration. We can switch very easily from a provider to another.</p></div>

<h1 id="jboss-configuration">JBoss configuration<a hidden class="anchor" aria-hidden="true" href="#jboss-configuration">#</a></h1>
<p>In this chapter, we will setup  JBoss EAP file a.k.a <strong>standalone.xml</strong>.</p>
<h2 id="system-properties">System properties<a hidden class="anchor" aria-hidden="true" href="#system-properties">#</a></h2>
<p>We set all WebSphereMQ connection environment settings we&rsquo;ve seen in the <strong>jboss-ejb3.xml</strong> file.</p>
<pre tabindex="0"><code>&lt;system-properties&gt;
  &lt;property name=&#34;websphere.hostName&#34;         value=&#34;localhost&#34;/&gt;
  &lt;property name=&#34;websphere.port&#34;             value=&#34;1414&#34;/&gt;
  &lt;property name=&#34;websphere.username&#34;         value=&#34;mqm&#34;/&gt;
  &lt;property name=&#34;websphere.password&#34;         value=&#34;mqm&#34;/&gt;
  &lt;property name=&#34;websphere.channel&#34;          value=&#34;SYSTEM.AUTO.SVRCONN&#34;/&gt;
  &lt;property name=&#34;websphere.transportType&#34;    value=&#34;CLIENT&#34;/&gt;
  &lt;property name=&#34;websphere.queueManager&#34;     value=&#34;QUEUE.MANAGER&#34;/&gt;
  &lt;property name=&#34;websphere.queueName&#34;        value=&#34;Q_QUEUE&#34;/&gt;
  &lt;property name=&#34;websphere.resource.adapter&#34; value=&#34;wmq.jmsra.rar&#34;/&gt;
&lt;/system-properties&gt;
</code></pre><div class="notice info" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#info-notice"></use></svg></span>Info</p><p>BINDING mode is the second transport type available to connect to WebsphereMQ, but operating-system binaries have to be installed.</p></div>

<h2 id="placeholders">Placeholders<a hidden class="anchor" aria-hidden="true" href="#placeholders">#</a></h2>
<p>JBoss will use system properties to replace placeholders with correct values inside several object type.</p>
<p>JBoss can manage placeholder replacements for :</p>
<ul>
<li>Standard Java EE descriptor files.
<ul>
<li><strong>spec-descriptor-property-replacement</strong></li>
<li>web.xml, ejb-jar.xml, etc&hellip;</li>
</ul>
</li>
<li>JBoss specific descriptor files.
<ul>
<li><strong>jboss-descriptor-property-replacement</strong></li>
<li>jboss-web.xml, jboss-ejb3.xml, etc&hellip;</li>
</ul>
</li>
<li>Annotations
<ul>
<li><strong>annotation-property-replacement</strong></li>
</ul>
</li>
</ul>
<br/>
<pre tabindex="0"><code>&lt;subsystem xmlns=&#34;urn:jboss:domain:ee:1.2&#34;&gt;
  &lt;spec-descriptor-property-replacement&gt;false&lt;/spec-descriptor-property-replacement&gt;
  &lt;jboss-descriptor-property-replacement&gt;true&lt;/jboss-descriptor-property-replacement&gt;
  &lt;annotation-property-replacement&gt;false&lt;/annotation-property-replacement&gt;
&lt;/subsystem&gt;
</code></pre><div class="notice note" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#note-notice"></use></svg></span>Note</p><p>I prefer use replacement only for JBoss specific descriptor files. Because another application server couldn&rsquo;t manage placeholder replacements inside Java EE standard descriptor files.</p></div>

<h2 id="wmq-connection-and-resource-adapter-configuration">WMQ connection and resource adapter configuration<a hidden class="anchor" aria-hidden="true" href="#wmq-connection-and-resource-adapter-configuration">#</a></h2>
<p>Finally, let&rsquo;s configure the WMQ resource adapter inside JBoss instance <strong>standalone.xml</strong>.</p>
<pre tabindex="0"><code>
&lt;subsystem xmlns=&#34;urn:jboss:domain:resource-adapters:1.1&#34;&gt;
  &lt;resource-adapters&gt;
    &lt;resource-adapter id=&#34;wmq.jmsra.rar&#34;&gt;
      &lt;archive&gt;wmq.jmsra.rar&lt;/archive&gt;
      &lt;transaction-support&gt;LocalTransaction&lt;/transaction-support&gt;
      &lt;connection-definitions&gt;
        &lt;connection-definition class-name=&#34;com.ibm.mq.connector.outbound.ManagedConnectionFactoryImpl&#34; jndi-name=&#34;java:/jboss/jms/wmq/connectionFactory&#34; use-java-context=&#34;true&#34; pool-name=&#34;MQConnectionFactory&#34;&gt;
          &lt;config-property name=&#34;port&#34;&gt;${websphere.port:1414}&lt;/config-property&gt;
          &lt;config-property name=&#34;hostName&#34;&gt;${websphere.hostName:localhost}&lt;/config-property&gt;
          &lt;config-property name=&#34;username&#34;&gt;${websphere.username:mqm}&lt;/config-property&gt;
          &lt;config-property name=&#34;password&#34;&gt;${websphere.password:mqm}&lt;/config-property&gt;
          &lt;config-property name=&#34;channel&#34;&gt;${websphere.channel:SYSTEM.AUTO.SVRCONN}&lt;/config-property&gt;
          &lt;config-property name=&#34;transportType&#34;&gt;${websphere.transportType:CLIENT}&lt;/config-property&gt;
          &lt;config-property name=&#34;queueManager&#34;&gt;${websphere.queueManager:QUEUE.MANAGER}&lt;/config-property&gt;
          &lt;security&gt;
            &lt;application/&gt;
          &lt;/security&gt;
        &lt;/connection-definition&gt;
      &lt;/connection-definitions&gt;
      &lt;admin-objects&gt;
        &lt;admin-object class-name=&#34;com.ibm.mq.connector.outbound.MQQueueProxy&#34; jndi-name=&#34;java:/jboss/jms/wmq/queue/Queue&#34; use-java-context=&#34;true&#34; pool-name=&#34;QueuePool&#34;&gt;
          &lt;config-property name=&#34;baseQueueManagerName&#34;&gt;${websphere.queueManager:QUEUE.MANAGER}&lt;/config-property&gt;
          &lt;config-property name=&#34;baseQueueName&#34;&gt;${websphere.queueName:Q_QUEUE}&lt;/config-property&gt;
        &lt;/admin-object&gt;
      &lt;/admin-objects&gt;
    &lt;/resource-adapter&gt;
  &lt;/resource-adapters&gt;
&lt;/subsystem&gt;
</code></pre><div class="notice info" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#info-notice"></use></svg></span>Info</p><p>You will notice we are still using placeholders into this part of JBoss configuration file.</p></div>

<p>Put the Websphere MQ resource adapter <strong>wmq.jmsra.rar</strong> and your application into JBoss instance deployment directory <strong>${JBOSS_HOME}/standalone/deployments</strong>.</p>
<p>Et voilà ;-)</p>
<h1 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h1>
<p>Integrating WebSphereMQ resource adapter is an easy operation on the JBoss application server. If you follow the general ideas in this post, it is possible to obtain a modular and easy application to maintain. Deploying your app in different environments (DEV , INT, PROD) is simplified, and only system properties in <strong>standalone.xml</strong> file should be changed.</p>
<br/>
<h2 id="url">URL<a hidden class="anchor" aria-hidden="true" href="#url">#</a></h2>
<ul>
<li><a href="https://access.redhat.com/documentation/en-US/JBoss_Enterprise_Application_Platform/6/html/Administration_and_Configuration_Guide/Deploy_the_WebSphere_MQ_Resource_Adapter.html">https://access.redhat.com/documentation/en-US/JBoss_Enterprise_Application_Platform/6/html/Administration_and_Configuration_Guide/Deploy_the_WebSphere_MQ_Resource_Adapter.html</a></li>
<li><a href="https://developer.jboss.org/message/738670">https://developer.jboss.org/message/738670</a></li>
<li><a href="https://developer.jboss.org/wiki/WebsphereMQIntegration">https://developer.jboss.org/wiki/WebsphereMQIntegration</a></li>
<li><a href="http://www-01.ibm.com/support/knowledgecenter/SSFKSJ_7.5.0/com.ibm.mq.dev.doc/q031760_.htm">The installation verification test program for the WebSphere MQ resource adapter</a></li>
<li><a href="/blog/2015/03/25/websphere-mq-jboss-eap-integration.html">French version</a></li>
</ul>
<h2 id="thanks">Thanks<a hidden class="anchor" aria-hidden="true" href="#thanks">#</a></h2>
<ul>
<li>Akram B. A. @RedHat for resources</li>
<li>Guillaume C. @RedHat for advices</li>
<li>Jean-Yves C. for corrections</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://gautric.github.io/tags/en/">En</a></li>
      <li><a href="https://gautric.github.io/tags/jboss/">JBoss</a></li>
      <li><a href="https://gautric.github.io/tags/eap/">Eap</a></li>
      <li><a href="https://gautric.github.io/tags/wildfly/">Wildfly</a></li>
      <li><a href="https://gautric.github.io/tags/webspheremq/">WebsphereMQ</a></li>
      <li><a href="https://gautric.github.io/tags/jca/">JCA</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://gautric.github.io/blog/2015/04/03/apache-camel-raspberrypi-poc/">
    <span class="title">« Prev</span>
    <br>
    <span>Apache Camel RaspberryPi PoC</span>
  </a>
  <a class="next" href="https://gautric.github.io/blog/2015/03/25/best-practices-websphere-mq/jboss-eap-6/">
    <span class="title">Next »</span>
    <br>
    <span>Best Practices Websphere MQ/JBoss EAP 6</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2016 - 2025 <a href="https://gautric.github.io/">Greg. I/O</a></span>
    
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
</body>

</html>
