<!DOCTYPE html>
<html><!--<![-->
<head>

  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="La construction des applications modernes et dites cloud natives passent obligatoirement par la case CI/CD. Les pipelines de type GitHub Action d’application..."/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Icon bar -->
  <link rel="apple-touch-icon" sizes="57x57" href="/img/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/img/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/img/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/img/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/img/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/img/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/img/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/img/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/img/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
  <meta name="robots" content="index,follow,noarchive" />
  <meta name="googlebot" content="noarchive" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="Greg I/O" />
  <meta name="twitter:site:id" content="@gautric_io" />
  <meta name="twitter:creator" content="@gautric_io" />
  <meta name="twitter:title" content="Quarkus/Java 11-17 et GitHub Action feat. Matrix" />
  <meta name="twitter:description" content="La construction des applications modernes et dites cloud natives passent obligatoirement par la case CI/CD. Les pipelines de type GitHub Action d’application..." />
  <meta name="twitter:image" content="/img/apple-icon-152x152.png" />

  <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="/blog/2022/06/08/GitHub-Matrix.html">
  <link rel="alternate" type="application/rss+xml" title="Greg I/Open" href="/feed.xml" />
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <title>Quarkus/Java 11-17 et GitHub Action feat. Matrix</title>
</head>

  <body>
        <header class="site-header blog-header">

  <div class="wrapper">

    <a class="site-title blog-site-title" href="/">Greg I/Open</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <a class="page-link" href="/apropos">A propos</a><a class="page-link" href="/blog">Blog</a><a class="page-link" href="/contact">Contact</a>
      </div>
    </nav>

  </div>

</header>


    <header class="post-header blog-title">
      <div class="wrapper">
      <h1 class="post-title">Quarkus/Java 11-17 et GitHub Action feat. Matrix</h1>
    </div>
    </header>

    <main class="page-content" role="main">
      <div class="wrapper">
          <article class="post-content">
    <p class="post-meta">Jun 8, 2022  <a href="#fr">fr</a>  <a href="#Java">Java</a>  <a href="#CI/CD">CI/CD</a>  <a href="#Quarkus">Quarkus</a> </p>
    <p>La construction des applications modernes et dites cloud natives passent obligatoirement par la case CI/CD. Les pipelines de type GitHub Action d’applications permettent de standardiser les processus de constructions, de tests, de versionning ainsi que de déploiement des applications. L’avantage des pipelines de constructions est le rapide feedback aux développeurs des erreurs dans la chaîne de traitement. Ainsi, il est facile de modifier un élément de configuration pour voir le résultat. 
Les applications modernes nécessitent de pouvoir migrer des socles techniques de manière transparente.</p>

<blockquote>
  <p>Compiler en Quarkus/Java 11 et 17 avec GitHub Action les Matrix</p>
</blockquote>

<p>L’idée dans ce post est de montrer très simplement un exemple de double compilation Java 11 et Java 17. Ces versions de Java sont des versions LTS<sup id="fnref:lts" role="doc-noteref"><a href="#fn:lts" class="footnote">1</a></sup> c’est-à-dire qu’elles disposent d’un support long terme .</p>

<p>Regardons rapidement le pipeline GitHub Action<sup id="fnref:gha" role="doc-noteref"><a href="#fn:gha" class="footnote">2</a></sup> avec la possibilité de compiler sur deux versions de Java différentes. Comme toutes les GitHub Action le fichier doit se trouver dans le répertoires .github/workflows de votre projet.</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">name</span><span class="pi">:</span> <span class="s">eaas-ci-matrix</span>

<span class="na">on</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">push</span><span class="pi">]</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">strategy</span><span class="pi">:</span>                        <span class="s">(1)</span>
      <span class="s">matrix</span><span class="pi">:</span>
        <span class="na">version</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">11</span><span class="pi">,</span> <span class="nv">17</span><span class="pi">]</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Checkout source</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v3</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Set up JDK ${{ matrix.version }}</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/setup-java@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">java-version</span><span class="pi">:</span> <span class="s">${{ matrix.version }}</span>
          <span class="na">distribution</span><span class="pi">:</span> <span class="s1">'</span><span class="s">adopt'</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build with Maven ${{ matrix.version }}</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">mvn --batch-mode --update-snapshots verify</span></code></pre></figure>

<p>Pour cela il faut simplement rajouter la section (1) dans la GitHub Action afin de configurer la matrice des versions de java avec lesquelles on souhaite compiler.</p>

<p>Suite à une modification (push) dans le repository, la GitHub Action va être déclenchée.</p>

<p><img src="/img/gha-java-matrix.png" alt="" /></p>

<p>GitHub Action va automatiquement créer autant de sous-pipeline que la matrice va prévoir.</p>

<p><img src="/img/gha-java-11.png" alt="Compilation Java 11" />
Voici l’exemple d’une compilation en Java 11</p>

<p><img src="/img/gha-java-17.png" alt="Compilation Java 17" />
et une compilation en Java 17</p>

<h2 id="conclusion">Conclusion</h2>

<p>Avec cet exemple très simple, nous voyons qu’il est possible d’ajouter rapidement des matrices de configuration afin de tester plusieurs cas en parallèle via les GitHub Action. Cette feature incluse dans GitHub facilite et permet d’accélérer les montées de version par exemple. On pourra utiliser cette feature pour changer de socle, de brique tech, de librairie, de framework en toute sérénité.</p>

<h4 id="footnotes">Footnotes</h4>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:lts" role="doc-endnote">
      <p>https://fr.wikipedia.org/wiki/Long-term_support <a href="#fnref:lts" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:gha" role="doc-endnote">
      <p>https://docs.github.com/en/actions <a href="#fnref:gha" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

  </article>

  <div class="post-social">
    

    

</div>


      </div>
    </main>

    <footer class="site-footer blog-footer">

  <div class="wrapper">

    <h2 class="footer-heading"><a href="#" title="Haut de la page / Head of page">Greg I/Open</a></h2>

    <div class="footer-col-wrapper">
      <p class="text">Cloud Architecte, Greg Autric, Web, Cloud, IoT, Automation, Red Hat, OpenSource</p>

      &mdash; 
 <a href="https://twitter.com/gautric_io">
    <span class="icon  icon--twitter">
      <svg viewBox="0 0 16 16">
        <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
        c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
      </svg>
    </span>
  </a>

 &mdash; 
  <a href="https://github.com/gautric">
    <span class="icon  icon--github">
      <svg viewBox="0 0 16 16">
        <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
      </svg>
    </span>
  </a>

 &mdash;
    </div>


  </div>

  <div class="copyright">Copyright © Greg Autric 2015 - 2024</div>


</footer>


  </body>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60791597-1', 'auto');
    ga('send', 'pageview');

  </script>

</html>
